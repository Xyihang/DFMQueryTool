# DFMæ¸¸æˆæ•°æ®æŸ¥è¯¢å·¥å…·ä»£ç å…¨è§£æ

å¸®åŠ©æ–‡æ¡£é“¾æ¥: https://docs.qq.com/document/DS2hWc29pSGVIa3dM

=== DFMæŸ¥è¯¢å·¥å…·ä½¿ç”¨è¯´æ˜ ===

1. ç”¨æˆ·é…ç½®ï¼š
   - è¾“å…¥æ‚¨çš„OpenIDå’ŒAccess Token
   - ç‚¹å‡»ä¿å­˜æŒ‰é’®ä¿å­˜é…ç½®

2. æŸ¥è¯¢åŠŸèƒ½ï¼š
   - é€‰æ‹©æŸ¥è¯¢ç±»å‹
   - ç‚¹å‡»æŸ¥è¯¢æ•°æ®è·å–ç»“æœ

3. æ”¯æŒçš„æŸ¥è¯¢ç±»å‹ï¼š
   - æ¯æ—¥å¯†ç ï¼šè·å–å½“æ—¥åœ°å›¾å¯†ç 
   - çƒ½ç«åœ°å¸¦æ”¶ç›ŠTop3ï¼šæŸ¥çœ‹æ˜¨æ—¥é«˜ä»·å€¼ç‰©å“
   - å…¨é¢æˆ˜åœºæ•°æ®ï¼šæŸ¥çœ‹MPæ¨¡å¼æˆ˜ç»©
   - æˆ˜åœºå‘¨æŠ¥æ•°æ®ï¼šæŸ¥çœ‹æœ¬å‘¨MPç»Ÿè®¡
   - çƒ½ç«å‘¨æŠ¥æ•°æ®ï¼šæŸ¥çœ‹æœ¬å‘¨Solç»Ÿè®¡
   - ç‰¹å‹¤å¤„çŠ¶æ€ï¼šæŸ¥çœ‹ç‰¹å‹¤å¤„è®¾æ–½çŠ¶æ€
   - è´§å¸èµ„äº§æŸ¥è¯¢ï¼šæŸ¥çœ‹æ¸¸æˆè´§å¸ä½™é¢

4. åŠŸèƒ½ç‰¹æ€§ï¼š
   - å¯æŠ˜å çš„ç”¨æˆ·é…ç½®åŒºåŸŸ
   - è‡ªåŠ¨ç‰©å“åç§°è¯†åˆ«
   - è¯¦ç»†çš„æ•°æ®æ ¼å¼åŒ–æ˜¾ç¤º
   - é”™è¯¯å¤„ç†å’ŒçŠ¶æ€æç¤º

5. å¸¸è§é—®é¢˜ï¼š
   - å¦‚æŸ¥è¯¢å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥
   - å¦‚æ˜¾ç¤ºé…ç½®é”™è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥å‡­è¯
   - å¯æŠ˜å é…ç½®åŒºåŸŸä»¥è·å¾—æ›´å¤§æŸ¥çœ‹ç©ºé—´

å®Œæ•´æ–‡æ¡£è¯·è®¿é—®ï¼šhttps://docs.qq.com/document/DS2hWc29pSGVIa3dM
## ä¸€ã€ä»£ç æ•´ä½“å®šä½ä¸æŠ€æœ¯æ ˆ
DFMæ¸¸æˆæ•°æ®æŸ¥è¯¢å·¥å…·æ˜¯åŸºäºPythonå¼€å‘çš„è·¨å¹³å°æ¡Œé¢åº”ç”¨ï¼Œä¸“ä¸ºâ€œçƒ½ç«åœ°å¸¦â€ï¼ˆDFMï¼‰æ¸¸æˆç©å®¶è®¾è®¡ï¼Œæ ¸å¿ƒåŠŸèƒ½æ˜¯èšåˆæŸ¥è¯¢æ¸¸æˆå¤šç»´åº¦æ•°æ®ï¼ŒåŒ…æ‹¬æ¯æ—¥å¯†ç ã€æˆ˜æ–—ç»Ÿè®¡ã€å‘¨æŠ¥æ•°æ®ã€èµ„äº§ç®¡ç†ç­‰ï¼Œè§£å†³ç©å®¶æ‰‹åŠ¨æŸ¥è¯¢æ•°æ®æ•ˆç‡ä½ã€ç»´åº¦åˆ†æ•£çš„ç—›ç‚¹ã€‚

æŠ€æœ¯æ ˆé€‰å‹èšç„¦è½»é‡åŒ–ä¸å®ç”¨æ€§ï¼Œå…·ä½“åŒ…æ‹¬ï¼š
- **UIæ¡†æ¶**ï¼šTogaï¼Œå®ç°è·¨å¹³å°åŸç”Ÿé£æ ¼ç•Œé¢ï¼Œæ”¯æŒWindowsã€macOSã€Linuxï¼Œæ— éœ€å•ç‹¬é€‚é…ä¸åŒç³»ç»ŸUIï¼›
- **ç½‘ç»œè¯·æ±‚**ï¼šrequestsï¼Œå¤„ç†HTTP POSTè¯·æ±‚ï¼Œè°ƒç”¨æ¸¸æˆå®˜æ–¹APIè·å–æ•°æ®ï¼Œæ”¯æŒè¶…æ—¶æ§åˆ¶ä¸å¼‚å¸¸æ•è·ï¼›
- **é…ç½®ç®¡ç†**ï¼šconfigparserï¼Œè¯»å†™INIæ ¼å¼é…ç½®æ–‡ä»¶ï¼Œå­˜å‚¨ç”¨æˆ·OpenIDä¸Access Tokenï¼Œç¡®ä¿å‡­è¯æŒä¹…åŒ–ï¼›
- **å‰ªè´´æ¿æ“ä½œ**ï¼špyperclipï¼Œå®ç°å¸®åŠ©æ–‡æ¡£ä¸€é”®å¤åˆ¶ï¼Œæå‡ç”¨æˆ·æ“ä½œä¾¿æ·æ€§ï¼›
- **æ—¶é—´å¤„ç†**ï¼šdatetimeä¸timedeltaï¼Œè®¡ç®—å‘¨æŠ¥ç»Ÿè®¡å‘¨æœŸã€æ ¼å¼åŒ–æ—¶é—´æ˜¾ç¤ºï¼ŒåŒ¹é…æ¸¸æˆæ•°æ®ç»Ÿè®¡è§„åˆ™ï¼›
- **æ•°æ®è§£æ**ï¼šjsonï¼Œè§£æAPIè¿”å›çš„JSONå“åº”ï¼Œå¤„ç†æ•°æ®æ ¼å¼è½¬æ¢ä¸å¼‚å¸¸ã€‚


## äºŒã€æ ¸å¿ƒç±»ä¸åˆå§‹åŒ–é€»è¾‘
### 1. æ ¸å¿ƒç±»å®šä¹‰ï¼šDFMQueryApp
ä»£ç ä»¥`DFMQueryApp`ç±»ä¸ºæ ¸å¿ƒï¼Œç»§æ‰¿è‡ªTogaçš„`App`ç±»ï¼Œå°è£…æ‰€æœ‰åŠŸèƒ½æ¨¡å—ï¼ŒåŒ…æ‹¬UIæ„å»ºã€é…ç½®ç®¡ç†ã€æ•°æ®æŸ¥è¯¢ã€ç»“æœæ ¼å¼åŒ–ç­‰ï¼Œç±»ç»“æ„æ¸…æ™°ï¼ŒèŒè´£ç»Ÿä¸€ã€‚

### 2. åˆå§‹åŒ–æ–¹æ³•ï¼ˆ__init__ï¼‰
```python
def __init__(self, *args, **kwargs):
    super().__init__(*args, **kwargs)
    self.config_file = None  # é…ç½®æ–‡ä»¶è·¯å¾„ï¼Œåç»­åœ¨startupä¸­åˆå§‹åŒ–
    self.openid = ""  # ç”¨æˆ·å”¯ä¸€æ ‡è¯†ï¼Œç”¨äºAPIèº«ä»½éªŒè¯
    self.access_token = ""  # ç”¨æˆ·è®¿é—®ä»¤ç‰Œï¼Œç”¨äºAPIæƒé™éªŒè¯
```
- è°ƒç”¨çˆ¶ç±»æ„é€ æ–¹æ³•ï¼Œç¡®ä¿Toga AppåŸºç¡€åŠŸèƒ½æ­£å¸¸åˆå§‹åŒ–ï¼›
- åˆå§‹åŒ–æ ¸å¿ƒé…ç½®å‚æ•°ï¼Œ`config_file`æš‚è®¾ä¸º`None`ï¼Œåç»­åœ¨`startup`æ–¹æ³•ä¸­ç»“åˆTogaçš„è·¯å¾„æ¥å£ç¡®å®šå…·ä½“è·¯å¾„ï¼›
- `openid`ä¸`access_token`åˆå§‹åŒ–ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œåç»­é€šè¿‡`load_config`æ–¹æ³•ä»é…ç½®æ–‡ä»¶åŠ è½½ã€‚


## ä¸‰ã€é…ç½®ç®¡ç†æ¨¡å—ï¼ˆload_configä¸save_configï¼‰
### 1. åŠ è½½é…ç½®ï¼ˆload_configï¼‰
è´Ÿè´£ä»æœ¬åœ°é…ç½®æ–‡ä»¶è¯»å–ç”¨æˆ·å‡­è¯ï¼Œç¡®ä¿åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨æ¢å¤ä¸Šæ¬¡é…ç½®ï¼Œæ ¸å¿ƒé€»è¾‘å¦‚ä¸‹ï¼š
```python
def load_config(self):
    if self.config_file is None:  # è‹¥é…ç½®æ–‡ä»¶è·¯å¾„æœªåˆå§‹åŒ–ï¼Œé‡ç½®å‡­è¯
        self.openid = ""
        self.access_token = ""
        return
    config = configparser.ConfigParser()
    if os.path.exists(self.config_file):  # æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œé¿å…FileNotFoundError
        config.read(self.config_file)
        if config.has_section('User'):  # éªŒè¯é…ç½®æ–‡ä»¶ç»“æ„åˆæ³•æ€§
            # è¯»å–OpenIDä¸Access Tokenï¼Œè®¾ç½®fallbacké»˜è®¤å€¼ä¸ºç©ºå­—ç¬¦ä¸²
            self.openid = config.get('User', 'openid', fallback='')
            self.access_token = config.get('User', 'access_token', fallback='')
```
- **å®¹é”™è®¾è®¡**ï¼šé€šè¿‡`os.path.exists`æ£€æŸ¥æ–‡ä»¶å­˜åœ¨æ€§ã€`has_section`éªŒè¯é…ç½®ç»“æ„ã€`fallback`è®¾ç½®é»˜è®¤å€¼ï¼Œé¿å…é…ç½®æ–‡ä»¶æŸåæˆ–ç¼ºå¤±å¯¼è‡´åº”ç”¨å´©æºƒï¼›
- **æ•°æ®æ¸…æ´—**ï¼šåç»­åœ¨`save_user_config`ä¸­é€šè¿‡`strip()`å¤„ç†è¾“å…¥ï¼Œç¡®ä¿åŠ è½½çš„å‡­è¯æ— å¤šä½™ç©ºæ ¼ï¼Œå‡å°‘APIè¯·æ±‚é”™è¯¯ã€‚

### 2. ä¿å­˜é…ç½®ï¼ˆsave_configï¼‰
è´Ÿè´£å°†ç”¨æˆ·è¾“å…¥çš„OpenIDä¸Access Tokenå†™å…¥æœ¬åœ°é…ç½®æ–‡ä»¶ï¼Œå®ç°å‡­è¯æŒä¹…åŒ–ï¼š
```python
def save_config(self):
    config = configparser.ConfigParser()
    # æ„å»ºUser sectionï¼Œå­˜å‚¨å½“å‰å‡­è¯
    config['User'] = {
        'openid': self.openid,
        'access_token': self.access_token
    }
    # ä»¥UTF-8ç¼–ç å†™å…¥æ–‡ä»¶ï¼Œé¿å…ä¸­æ–‡ä¹±ç ï¼ˆæœªæ¥æ‰©å±•ä¸­æ–‡é…ç½®æ—¶å…¼å®¹ï¼‰
    with open(self.config_file, 'w', encoding='utf-8') as configfile:
        config.write(configfile)
```
- **è¦†ç›–å†™å…¥**ï¼šæ¯æ¬¡ä¿å­˜æ—¶é‡æ–°æ„å»º`User` sectionï¼Œç¡®ä¿é…ç½®å§‹ç»ˆä¸ºæœ€æ–°çŠ¶æ€ï¼Œé¿å…æ—§å€¼æ®‹ç•™ï¼›
- **ç¼–ç è§„èŒƒ**ï¼šæŒ‡å®š`encoding='utf-8'`ï¼Œå…¼å®¹æœªæ¥å¯èƒ½çš„ä¸­æ–‡å¤‡æ³¨ä¿¡æ¯ï¼Œæå‡ä»£ç æ‰©å±•æ€§ã€‚


## å››ã€UIæ„å»ºæ¨¡å—ï¼ˆstartupæ–¹æ³•ï¼‰
`startup`æ˜¯Togaæ¡†æ¶çš„æ ¸å¿ƒæ–¹æ³•ï¼Œè´Ÿè´£åˆå§‹åŒ–ä¸»çª—å£ä¸æ‰€æœ‰UIç»„ä»¶ï¼Œæ„å»ºå®Œæ•´äº¤äº’ç•Œé¢ï¼Œæ•´ä½“é‡‡ç”¨â€œç›’å­åµŒå¥—ï¼ˆBoxï¼‰â€ç»“æ„ï¼Œé€šè¿‡`COLUMN`ï¼ˆå‚ç›´æ’åˆ—ï¼‰ä¸`ROW`ï¼ˆæ°´å¹³æ’åˆ—ï¼‰å®ç°çµæ´»å¸ƒå±€ï¼Œå…·ä½“ç»„ä»¶ä¸é€»è¾‘å¦‚ä¸‹ï¼š

### 1. ä¸»çª—å£åˆå§‹åŒ–
```python
self.main_window = toga.MainWindow(title="DFMæŸ¥è¯¢å·¥å…· --Made by Xyihang", size=(700, 650))
main_box = toga.Box(style=Pack(direction=COLUMN, margin=8))  # æ ¹å®¹å™¨ï¼Œå‚ç›´æ’åˆ—æ‰€æœ‰ç»„ä»¶
```
- è®¾å®šçª—å£æ ‡é¢˜ä¸å›ºå®šå°ºå¯¸ï¼ˆ700Ã—650ï¼‰ï¼Œå…¼é¡¾æ˜¾ç¤ºå®Œæ•´æ€§ä¸æ¡Œé¢é€‚é…æ€§ï¼›
- æ ¹å®¹å™¨`main_box`è®¾ç½®`margin=8`ï¼Œé¿å…ç»„ä»¶ç´§è´´çª—å£è¾¹ç¼˜ï¼Œæå‡è§†è§‰èˆ’é€‚åº¦ã€‚

### 2. æ ‡é¢˜ç»„ä»¶
```python
title_label = toga.Label(
    "DFMæ¸¸æˆæ•°æ®æŸ¥è¯¢å·¥å…· --Made by Xyihang",
    style=Pack(font_size=18, font_weight="bold", margin_bottom=15)
)
main_box.add(title_label)
```
- é‡‡ç”¨å¤§å­—ä½“ï¼ˆ18å·ï¼‰ä¸åŠ ç²—æ ·å¼ï¼Œçªå‡ºå·¥å…·åç§°ï¼Œ`margin_bottom=15`ä¸ä¸‹æ–¹ç»„ä»¶åˆ†éš”ï¼Œè§†è§‰å±‚æ¬¡æ¸…æ™°ã€‚

### 3. ç”¨æˆ·é…ç½®åŒºåŸŸï¼ˆå¯æŠ˜å ï¼‰
é…ç½®åŒºåŸŸæ˜¯ç”¨æˆ·è¾“å…¥å‡­è¯çš„æ ¸å¿ƒæ¨¡å—ï¼Œæ”¯æŒæŠ˜å /å±•å¼€ï¼ŒèŠ‚çœç•Œé¢ç©ºé—´ï¼Œç”±â€œå¤´éƒ¨ï¼ˆæ ‡é¢˜+æŠ˜å æŒ‰é’®+ä¿å­˜æŒ‰é’®ï¼‰â€ä¸â€œå†…å®¹ï¼ˆè¾“å…¥æ¡†+çŠ¶æ€æ˜¾ç¤ºï¼‰â€ç»„æˆï¼š
#### ï¼ˆ1ï¼‰å¤´éƒ¨ç»„ä»¶ï¼ˆheader_boxï¼‰
```python
header_box = toga.Box(style=Pack(direction=ROW, margin_bottom=5))
# é…ç½®æ ‡é¢˜
config_label = toga.Label("ç”¨æˆ·é…ç½®", style=Pack(font_size=14, font_weight="bold"))
# æŠ˜å /å±•å¼€æŒ‰é’®ï¼Œåˆå§‹æ–‡æœ¬ä¸º"â–²"ï¼ˆå±•å¼€çŠ¶æ€ï¼‰
self.toggle_button = toga.Button(
    "â–²",
    on_press=self.toggle_config,
    style=Pack(margin_left=10, padding=(5, 2), background_color="#607D8B", color="white", width=30)
)
# ä¿å­˜æŒ‰é’®ï¼Œè“è‰²èƒŒæ™¯çªå‡ºæ“ä½œ
save_button = toga.Button(
    "ä¿å­˜",
    on_press=self.save_user_config,
    style=Pack(margin_left=5, padding=(5, 2), background_color="#2196F3", color="white")
)
header_box.add(config_label)
header_box.add(self.toggle_button)
header_box.add(save_button)
```
- **äº¤äº’è®¾è®¡**ï¼šæŠ˜å æŒ‰é’®ç»‘å®š`toggle_config`æ–¹æ³•ï¼Œç‚¹å‡»åˆ‡æ¢æ˜¾ç¤ºçŠ¶æ€ï¼›ä¿å­˜æŒ‰é’®ç»‘å®š`save_user_config`ï¼Œè§¦å‘é…ç½®ä¿å­˜ï¼›
- **è§†è§‰åŒºåˆ†**ï¼šæŒ‰é’®é‡‡ç”¨ä¸åŒèƒŒæ™¯è‰²ï¼ˆæŠ˜å æŒ‰é’®#607D8Bã€ä¿å­˜æŒ‰é’®#2196F3ï¼‰ï¼Œå¼•å¯¼ç”¨æˆ·è¯†åˆ«æ“ä½œåŠŸèƒ½ã€‚

#### ï¼ˆ2ï¼‰è¾“å…¥æ¡†å®¹å™¨ï¼ˆinputs_containerï¼‰
åŒ…å«OpenIDä¸Access Tokenä¸¤ä¸ªè¾“å…¥æ¡†ï¼Œé‡‡ç”¨æ°´å¹³æ’åˆ—ï¼ˆROWï¼‰ç¡®ä¿æ ‡ç­¾ä¸è¾“å…¥æ¡†å¯¹é½ï¼š
```python
inputs_container = toga.Box(style=Pack(direction=COLUMN))
# OpenIDè¾“å…¥æ¡†
openid_box = toga.Box(style=Pack(direction=ROW, margin=2))
openid_label = toga.Label("OpenID:", style=Pack(width=70, margin_right=8, font_size=12))
self.openid_input = toga.TextInput(
    placeholder="è¯·è¾“å…¥OpenID",
    value=self.openid,  # åŠ è½½å·²ä¿å­˜çš„OpenID
    style=Pack(flex=1, height=30)  # flex=1è‡ªé€‚åº”å®½åº¦ï¼Œheight=30ç¡®ä¿è¾“å…¥æ¡†é«˜åº¦ç»Ÿä¸€
)
openid_box.add(openid_label)
openid_box.add(self.openid_input)

# Access Tokenè¾“å…¥æ¡†ï¼ˆç»“æ„ä¸OpenIDè¾“å…¥æ¡†ä¸€è‡´ï¼‰
token_box = toga.Box(style=Pack(direction=ROW, margin=2))
token_label = toga.Label("Access Token:", style=Pack(width=70, margin_right=8, font_size=12))
self.token_input = toga.TextInput(
    placeholder="è¯·è¾“å…¥Access Token",
    value=self.access_token,
    style=Pack(flex=1, height=30)
)
token_box.add(token_label)
token_box.add(self.token_input)

inputs_container.add(openid_box)
inputs_container.add(token_box)
```
- **è‡ªé€‚åº”å¸ƒå±€**ï¼šè¾“å…¥æ¡†è®¾ç½®`flex=1`ï¼Œéšçª—å£å®½åº¦å˜åŒ–è‡ªåŠ¨è°ƒæ•´ï¼Œé¿å…çª—å£ç¼©æ”¾å¯¼è‡´å¸ƒå±€é”™ä¹±ï¼›
- **æ•°æ®é¢„å¡«**ï¼šè¾“å…¥æ¡†`value`å±æ€§ç»‘å®šå·²åŠ è½½çš„`openid`ä¸`access_token`ï¼Œç”¨æˆ·æ— éœ€é‡å¤è¾“å…¥ï¼Œæå‡æ“ä½œæ•ˆç‡ã€‚

#### ï¼ˆ3ï¼‰çŠ¶æ€æ˜¾ç¤ºï¼ˆstatus_boxï¼‰
å®æ—¶æ˜¾ç¤ºå½“å‰é…ç½®çš„ç”¨æˆ·ä¿¡æ¯ï¼Œéšè—è¿‡é•¿çš„OpenIDï¼Œä¿æŠ¤ç”¨æˆ·éšç§ï¼š
```python
status_box = toga.Box(style=Pack(direction=ROW, margin_top=5))
self.user_info_label = toga.Label(
    f"ç”¨æˆ·: {self.openid[:10] + '...' if self.openid and len(self.openid) > 10 else (self.openid if self.openid else 'æœªè®¾ç½®')}",
    style=Pack(font_size=10, color="gray")
)
status_box.add(self.user_info_label)
```
- **éšç§ä¿æŠ¤**ï¼šOpenIDé•¿åº¦è¶…è¿‡10æ—¶æˆªæ–­å¹¶æ·»åŠ â€œ...â€ï¼Œé¿å…å®Œæ•´å‡­è¯æ³„éœ²ï¼›
- **çŠ¶æ€æ˜ç¡®**ï¼šæœªé…ç½®æ—¶æ˜¾ç¤ºâ€œæœªè®¾ç½®â€ï¼Œç”¨æˆ·å¯å¿«é€Ÿç¡®è®¤é…ç½®çŠ¶æ€ï¼Œæ— éœ€è¿›å…¥è¾“å…¥æ¡†æ£€æŸ¥ã€‚

#### ï¼ˆ4ï¼‰é…ç½®åŒºåŸŸç»„è£…ä¸åˆå§‹çŠ¶æ€
```python
# å¯æŠ˜å çš„å†…å®¹å®¹å™¨ï¼ŒåŒ…å«è¾“å…¥æ¡†ä¸çŠ¶æ€æ˜¾ç¤º
self.config_content = toga.Box(style=Pack(direction=COLUMN))
self.config_content.add(inputs_container)
self.config_content.add(status_box)

# ç»„è£…é…ç½®åŒºåŸŸ
self.config_box = toga.Box(style=Pack(direction=COLUMN, margin=5, background_color="#f5f5f5"))
self.config_box.add(header_box)
self.config_box.add(self.config_content)

# åˆå§‹çŠ¶æ€ä¸ºå±•å¼€ï¼ˆconfig_visible=Trueï¼‰
self.config_visible = True
main_box.add(self.config_box)
```
- **è§†è§‰åŒºåˆ†**ï¼šé…ç½®åŒºåŸŸèƒŒæ™¯è‰²è®¾ä¸º`#f5f5f5`ï¼Œä¸å…¶ä»–åŒºåŸŸå½¢æˆå¯¹æ¯”ï¼Œä¾¿äºç”¨æˆ·è¯†åˆ«åŠŸèƒ½æ¨¡å—ï¼›
- **åˆå§‹çŠ¶æ€**ï¼šé»˜è®¤å±•å¼€é…ç½®åŒºåŸŸï¼Œå¼•å¯¼æ–°ç”¨æˆ·å®Œæˆå‡­è¯é…ç½®ï¼Œé™ä½ä½¿ç”¨é—¨æ§›ã€‚

### 4. æŸ¥è¯¢ç±»å‹é€‰æ‹©å™¨ï¼ˆquery_type_boxï¼‰
æä¾›7ç§æŸ¥è¯¢ç±»å‹ï¼Œç”¨æˆ·å¯é€šè¿‡ä¸‹æ‹‰é€‰æ‹©éœ€è¦æŸ¥è¯¢çš„æ•°æ®ï¼š
```python
query_type_box = toga.Box(style=Pack(direction=ROW, margin=5))
query_type_label = toga.Label("æŸ¥è¯¢ç±»å‹:", style=Pack(font_size=14, margin_right=10))
self.query_type = toga.Selection(
    items=["æ¯æ—¥å¯†ç ", "çƒ½ç«åœ°å¸¦æ”¶ç›ŠTop3", "å…¨é¢æˆ˜åœºæ•°æ®", "æˆ˜åœºå‘¨æŠ¥æ•°æ®", "çƒ½ç«å‘¨æŠ¥æ•°æ®", "ç‰¹å‹¤å¤„çŠ¶æ€", "è´§å¸èµ„äº§æŸ¥è¯¢"],
    style=Pack(flex=1)
)
query_type_box.add(query_type_label)
query_type_box.add(self.query_type)
main_box.add(query_type_box)
```
- **è¦†ç›–å…¨åœºæ™¯**ï¼šæŸ¥è¯¢ç±»å‹æ¶µç›–æ—¥å¸¸æ¸¸æˆï¼ˆæ¯æ—¥å¯†ç ï¼‰ã€æˆ˜æ–—ç»Ÿè®¡ï¼ˆå…¨é¢æˆ˜åœºæ•°æ®ï¼‰ã€å‘¨æ€»ç»“ï¼ˆæˆ˜åœºå‘¨æŠ¥ï¼‰ã€èµ„äº§ç®¡ç†ï¼ˆè´§å¸èµ„äº§æŸ¥è¯¢ï¼‰ï¼Œæ»¡è¶³ç©å®¶æ ¸å¿ƒéœ€æ±‚ï¼›
- **è‡ªé€‚åº”å®½åº¦**ï¼šé€‰æ‹©å™¨è®¾ç½®`flex=1`ï¼Œä¸è¾“å…¥æ¡†å®½åº¦ä¿æŒä¸€è‡´ï¼Œå¸ƒå±€æ›´è§„æ•´ã€‚

### 5. åŠŸèƒ½æŒ‰é’®å®¹å™¨ï¼ˆbutton_containerï¼‰
åŒ…å«â€œæŸ¥è¯¢æ•°æ®â€ä¸â€œè·å–å¸®åŠ©â€ä¸¤ä¸ªæ ¸å¿ƒæŒ‰é’®ï¼Œæ°´å¹³æ’åˆ—ç¡®ä¿æ“ä½œä¾¿æ·ï¼š
```python
button_container = toga.Box(style=Pack(direction=ROW, margin=5))
# æŸ¥è¯¢æŒ‰é’®ï¼Œç»¿è‰²èƒŒæ™¯çªå‡ºæ ¸å¿ƒæ“ä½œ
query_button = toga.Button(
    "æŸ¥è¯¢æ•°æ®",
    on_press=self.query_data,
    style=Pack(flex=1, margin_right=5, background_color="#4CAF50", color="white")
)
# å¸®åŠ©æŒ‰é’®ï¼Œæ©™è‰²èƒŒæ™¯åŒºåˆ†è¾…åŠ©åŠŸèƒ½
help_button = toga.Button(
    "è·å–å¸®åŠ©",
    on_press=self.get_help,
    style=Pack(flex=1, background_color="#FF9800", color="white")
)
button_container.add(query_button)
button_container.add(help_button)
main_box.add(button_container)
```
- **åŠŸèƒ½åŒºåˆ†**ï¼šæŸ¥è¯¢æŒ‰é’®ï¼ˆç»¿è‰²ï¼‰ä¸ºæ ¸å¿ƒæ“ä½œï¼Œå¸®åŠ©æŒ‰é’®ï¼ˆæ©™è‰²ï¼‰ä¸ºè¾…åŠ©åŠŸèƒ½ï¼Œé€šè¿‡è‰²å½©å¼•å¯¼ç”¨æˆ·æ“ä½œä¼˜å…ˆçº§ï¼›
- **å‡ç­‰å®½åº¦**ï¼šä¸¤ä¸ªæŒ‰é’®å‡è®¾ç½®`flex=1`ï¼Œå®½åº¦å‡ç­‰ï¼Œå¸ƒå±€å¯¹ç§°ç¾è§‚ã€‚

### 6. ç»“æœæ˜¾ç¤ºåŒºåŸŸ
åŒ…å«ç»“æœæ ‡é¢˜ä¸å¤šè¡Œæ–‡æœ¬æ¡†ï¼Œç”¨äºå±•ç¤ºæŸ¥è¯¢ç»“æœï¼Œæ”¯æŒé•¿æ–‡æœ¬æ»šåŠ¨ï¼š
```python
# ç»“æœæ ‡é¢˜
result_label = toga.Label("æŸ¥è¯¢ç»“æœ:", style=Pack(font_size=14, font_weight="bold", margin_top=10))
main_box.add(result_label)

# ç»“æœæ–‡æœ¬æ¡†ï¼Œåªè¯»æ¨¡å¼ï¼Œæ”¯æŒæ»šåŠ¨
self.result_text = toga.MultilineTextInput(
    style=Pack(flex=1, margin=5, padding=10),
    readonly=True,
    placeholder="é€‰æ‹©æŸ¥è¯¢ç±»å‹å¹¶ç‚¹å‡»æŸ¥è¯¢æŒ‰é’®è·å–æ•°æ®..."
)
main_box.add(self.result_text)
```
- **åªè¯»ä¿æŠ¤**ï¼šè®¾ç½®`readonly=True`ï¼Œé¿å…ç”¨æˆ·è¯¯ä¿®æ”¹ç»“æœï¼Œç¡®ä¿æ•°æ®å®Œæ•´æ€§ï¼›
- **æç¤ºå¼•å¯¼**ï¼šå ä½æ–‡æœ¬æç¤ºç”¨æˆ·æ“ä½œæµç¨‹ï¼Œæ–°ç”¨æˆ·å¯å¿«é€Ÿç†è§£ä½¿ç”¨æ–¹æ³•ï¼›
- **è‡ªé€‚åº”é«˜åº¦**ï¼š`flex=1`è®¾ç½®è®©æ–‡æœ¬æ¡†å æ®å‰©ä½™å‚ç›´ç©ºé—´ï¼Œå¤§é‡æ•°æ®å¯é€šè¿‡æ»šåŠ¨æŸ¥çœ‹ï¼Œæ— éœ€æ‹…å¿ƒæ˜¾ç¤ºä¸å…¨ã€‚

### 7. çŠ¶æ€æ ï¼ˆstatus_labelï¼‰
å®æ—¶æ˜¾ç¤ºåº”ç”¨çŠ¶æ€ï¼Œå¦‚â€œå°±ç»ªâ€â€œæŸ¥è¯¢ä¸­â€â€œæŸ¥è¯¢æˆåŠŸâ€â€œé”™è¯¯â€ï¼Œæå‡ç”¨æˆ·æ“ä½œæ„ŸçŸ¥ï¼š
```python
self.status_label = toga.Label("å°±ç»ª", style=Pack(font_size=10, color="gray", margin_top=5))
main_box.add(self.status_label)
```
- **çŠ¶æ€æ˜ç¡®**ï¼šä¸åŒæ“ä½œå¯¹åº”ä¸åŒçŠ¶æ€æ–‡æœ¬ï¼Œç”¨æˆ·å¯å®æ—¶äº†è§£åº”ç”¨è¿è¡Œæƒ…å†µï¼Œé¿å…ç›²ç›®ç­‰å¾…ï¼›
- **è§†è§‰å¼±åŒ–**ï¼šé‡‡ç”¨ç°è‰²å°å­—ä½“ï¼ˆ10å·ï¼‰ï¼Œæ—¢ä¼ é€’ä¿¡æ¯åˆä¸å¹²æ‰°æ ¸å¿ƒåŠŸèƒ½ï¼Œè§†è§‰å±‚çº§åˆç†ã€‚

### 8. çª—å£å±•ç¤º
```python
self.main_window.content = main_box
self.main_window.show()
```
- å°†æ ¹å®¹å™¨`main_box`è®¾ä¸ºçª—å£å†…å®¹ï¼Œè°ƒç”¨`show()`æ˜¾ç¤ºçª—å£ï¼Œå®ŒæˆUIåˆå§‹åŒ–ã€‚


## äº”ã€é…ç½®äº¤äº’åŠŸèƒ½ï¼ˆtoggle_configä¸save_user_configï¼‰
### 1. é…ç½®åŒºåŸŸæŠ˜å /å±•å¼€ï¼ˆtoggle_configï¼‰
å®ç°é…ç½®åŒºåŸŸçš„æ˜¾ç¤ºä¸éšè—åˆ‡æ¢ï¼ŒèŠ‚çœç•Œé¢ç©ºé—´ï¼Œæ ¸å¿ƒé€»è¾‘æ˜¯â€œç§»é™¤/æ·»åŠ é…ç½®å†…å®¹å®¹å™¨â€ä¸â€œåˆ‡æ¢æŒ‰é’®æ–‡æœ¬â€ï¼š
```python
def toggle_config(self, widget):
    try:
        if hasattr(self, 'config_visible') and self.config_visible:
            # éšè—é…ç½®å†…å®¹ï¼šä»config_boxä¸­ç§»é™¤config_content
            self.config_box.remove(self.config_content)
            self.toggle_button.text = "â–¼"  # æŒ‰é’®æ–‡æœ¬æ”¹ä¸º"â–¼"ï¼Œæç¤ºå¯å±•å¼€
            self.config_visible = False
        else:
            # æ˜¾ç¤ºé…ç½®å†…å®¹ï¼šå‘config_boxä¸­æ·»åŠ config_content
            self.config_box.add(self.config_content)
            self.toggle_button.text = "â–²"  # æŒ‰é’®æ–‡æœ¬æ”¹ä¸º"â–²"ï¼Œæç¤ºå¯æŠ˜å 
            self.config_visible = True
    except Exception as e:
        print(f"åˆ‡æ¢é…ç½®åŒºåŸŸæ—¶å‡ºé”™: {e}")
```
- **å¼‚å¸¸æ•è·**ï¼šé€šè¿‡`try-except`æ•è·æ“ä½œå¼‚å¸¸ï¼Œé¿å…ç•Œé¢å¡æ­»ï¼ŒåŒæ—¶æ‰“å°é”™è¯¯ä¿¡æ¯ä¾¿äºè°ƒè¯•ï¼›
- **çŠ¶æ€åŒæ­¥**ï¼š`config_visible`å˜é‡è®°å½•å½“å‰çŠ¶æ€ï¼Œç¡®ä¿æŒ‰é’®æ–‡æœ¬ä¸æ˜¾ç¤ºçŠ¶æ€ä¸€è‡´ï¼Œé¿å…äº¤äº’æ··ä¹±ã€‚

### 2. ä¿å­˜ç”¨æˆ·é…ç½®ï¼ˆsave_user_configï¼‰
è·å–è¾“å…¥æ¡†å†…å®¹ï¼ŒéªŒè¯å¹¶ä¿å­˜é…ç½®ï¼ŒåŒæ—¶æ›´æ–°çŠ¶æ€æ˜¾ç¤ºï¼š
```python
def save_user_config(self, widget):
    try:
        # è·å–è¾“å…¥æ¡†å†…å®¹å¹¶å»é™¤å¤šä½™ç©ºæ ¼
        self.openid = self.openid_input.value.strip()
        self.access_token = self.token_input.value.strip()
        
        # éªŒè¯OpenIDéç©ºï¼ˆæ ¸å¿ƒå‡­è¯ï¼Œç¼ºå¤±ä¼šå¯¼è‡´APIè¯·æ±‚å¤±è´¥ï¼‰
        if not self.openid:
            self.result_text.value = "é”™è¯¯: OpenIDä¸èƒ½ä¸ºç©º"
            return
        
        # ä¿å­˜é…ç½®åˆ°æœ¬åœ°æ–‡ä»¶
        self.save_config()
        
        # æ›´æ–°ç”¨æˆ·çŠ¶æ€æ˜¾ç¤ºï¼Œåæ˜ æœ€æ–°é…ç½®
        self.user_info_label.text = f"ç”¨æˆ·: {self.openid[:10] + '...' if self.openid and len(self.openid) > 10 else (self.openid if self.openid else 'æœªè®¾ç½®')}"
        
        # æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯ï¼Œå¼•å¯¼ç”¨æˆ·åç»­æ“ä½œ
        self.result_text.value = "é…ç½®ä¿å­˜æˆåŠŸï¼\n\nç°åœ¨å¯ä»¥ä½¿ç”¨æŸ¥è¯¢åŠŸèƒ½äº†ã€‚"
        self.status_label.text = "é…ç½®å·²ä¿å­˜"
    except Exception as e:
        # å¼‚å¸¸æ—¶æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ï¼Œå¸®åŠ©ç”¨æˆ·æ’æŸ¥é—®é¢˜
        self.result_text.value = f"ä¿å­˜é…ç½®æ—¶å‘ç”Ÿé”™è¯¯: {str(e)}"
        self.status_label.text = "ä¿å­˜å¤±è´¥"
```
- **æ•°æ®æ¸…æ´—**ï¼šé€šè¿‡`strip()`å»é™¤è¾“å…¥å†…å®¹çš„å‰åç©ºæ ¼ï¼Œé¿å…å› ç©ºæ ¼å¯¼è‡´çš„å‡­è¯é”™è¯¯ï¼›
- **å‰ç½®éªŒè¯**ï¼šæ£€æŸ¥OpenIDéç©ºï¼Œæå‰æ‹¦æˆªæ— æ•ˆé…ç½®ï¼Œå‡å°‘åç»­APIè¯·æ±‚å¤±è´¥ï¼›
- **åé¦ˆåŠæ—¶**ï¼šä¿å­˜æˆåŠŸåæ›´æ–°çŠ¶æ€æ ‡ç­¾ä¸ç»“æœæ–‡æœ¬ï¼Œç”¨æˆ·å¯æ˜ç¡®çŸ¥æ™“æ“ä½œç»“æœï¼ŒåŒæ—¶å¼•å¯¼ä½¿ç”¨æŸ¥è¯¢åŠŸèƒ½ã€‚


## å…­ã€æ ¸å¿ƒåŠŸèƒ½ï¼šæ•°æ®æŸ¥è¯¢ï¼ˆquery_dataæ–¹æ³•ï¼‰
`query_data`æ˜¯æ•°æ®æŸ¥è¯¢çš„æ ¸å¿ƒå…¥å£ï¼Œè´Ÿè´£æ ¹æ®ç”¨æˆ·é€‰æ‹©çš„æŸ¥è¯¢ç±»å‹ï¼Œæ„é€ APIè¯·æ±‚ã€å¤„ç†å“åº”ã€è°ƒç”¨æ ¼å¼åŒ–æ–¹æ³•ï¼Œæ˜¯è¿æ¥UIä¸æ•°æ®çš„å…³é”®æ¨¡å—ï¼Œé€»è¾‘æµç¨‹å¦‚ä¸‹ï¼š

### 1. åˆå§‹åŒ–çŠ¶æ€ä¸å‰ç½®éªŒè¯
```python
def query_data(self, widget):
    try:
        # æ›´æ–°çŠ¶æ€æ ä¸ºâ€œæŸ¥è¯¢ä¸­â€ï¼Œå‘ŠçŸ¥ç”¨æˆ·æ“ä½œè¿›åº¦
        self.status_label.text = "æ­£åœ¨æŸ¥è¯¢ä¸­..."
        
        # å‰ç½®éªŒè¯ï¼šæ£€æŸ¥OpenIDæ˜¯å¦é…ç½®ï¼Œæœªé…ç½®åˆ™æç¤ºé”™è¯¯
        if not self.openid:
            self.result_text.value = "é”™è¯¯: è¯·å…ˆåœ¨ç”¨æˆ·é…ç½®åŒºåŸŸè®¾ç½®OpenIDå¹¶ä¿å­˜é…ç½®"
            self.status_label.text = "é…ç½®ä¸å®Œæ•´"
            return
```
- **çŠ¶æ€åé¦ˆ**ï¼šæŸ¥è¯¢å¼€å§‹å³æ›´æ–°çŠ¶æ€æ ï¼Œé¿å…ç”¨æˆ·å› æ— åé¦ˆè€Œé‡å¤ç‚¹å‡»ï¼›
- **å‰ç½®æ‹¦æˆª**ï¼šéªŒè¯OpenIDé…ç½®ï¼Œå‡å°‘æ— æ•ˆAPIè¯·æ±‚ï¼Œæå‡æ•ˆç‡å¹¶é™ä½æœåŠ¡å™¨å‹åŠ›ã€‚

### 2. ç»‘å®šæŸ¥è¯¢ç±»å‹ä¸å‚æ•°
æ ¹æ®ç”¨æˆ·é€‰æ‹©çš„æŸ¥è¯¢ç±»å‹ï¼Œç¡®å®šAPIè¯·æ±‚å‚æ•°ã€æŸ¥è¯¢å‡½æ•°ï¼ˆ`query_func`ï¼‰ä¸ç‰¹æ®Šå¤„ç†é€»è¾‘ï¼š
```python
        # æ ¹æ®æŸ¥è¯¢ç±»å‹ç»‘å®šå‚æ•°ä¸å¤„ç†å‡½æ•°
        query_type = self.query_type.value
        if query_type == "æ¯æ—¥å¯†ç ":
            param_value = '{}'  # æ— ç‰¹æ®Šå‚æ•°ï¼Œä¼ é€’ç©ºJSON
            query_func = self.query_daily_secret  # ç»‘å®šæ¯æ—¥å¯†ç æŸ¥è¯¢å‡½æ•°
        elif query_type == "çƒ½ç«åœ°å¸¦æ”¶ç›ŠTop3":
            param_value = '{"resourceType":"sol"}'  # å‚æ•°æŒ‡å®šsolç±»å‹ï¼ˆçƒ½ç«åœ°å¸¦ï¼‰
            query_func = self.query_sol_data  # ç»‘å®šçƒ½ç«åœ°å¸¦æ•°æ®æŸ¥è¯¢å‡½æ•°
        elif query_type == "å…¨é¢æˆ˜åœºæ•°æ®":
            param_value = '{"resourceType":"mp"}'  # å‚æ•°æŒ‡å®šmpç±»å‹ï¼ˆå…¨é¢æˆ˜åœºï¼‰
            query_func = self.query_mp_data  # ç»‘å®šå…¨é¢æˆ˜åœºæ•°æ®æŸ¥è¯¢å‡½æ•°
        elif query_type == "æˆ˜åœºå‘¨æŠ¥æ•°æ®":
            # è®¡ç®—æœ€è¿‘ä¸€ä¸ªå‘¨æ—¥æ—¥æœŸï¼ˆæ¸¸æˆå‘¨æŠ¥ç»Ÿè®¡å‘¨æœŸä¸ºå‘¨ä¸€è‡³å‘¨æ—¥ï¼‰
            today = datetime.now()
            days_since_sunday = today.weekday() + 1  # weekday()è¿”å›0=å‘¨ä¸€ï¼Œ6=å‘¨æ—¥ï¼Œ+1å0=å‘¨æ—¥
            last_sunday = today - timedelta(days=days_since_sunday % 7)
            stat_date = last_sunday.strftime('%Y%m%d')  # æ ¼å¼åŒ–ä¸ºYYYYMMDD
            param_value = f'{{"statDate":"{stat_date}"}}'  # å‚æ•°ä¼ é€’ç»Ÿè®¡æ—¥æœŸ
            query_func = self.query_weekly_data  # ç»‘å®šæˆ˜åœºå‘¨æŠ¥æŸ¥è¯¢å‡½æ•°
        elif query_type == "çƒ½ç«å‘¨æŠ¥æ•°æ®":
            # åŒæˆ˜åœºå‘¨æŠ¥ï¼Œè®¡ç®—æœ€è¿‘å‘¨æ—¥æ—¥æœŸ
            today = datetime.now()
            days_since_sunday = today.weekday() + 1
            last_sunday = today - timedelta(days=days_since_sunday % 7)
            stat_date = last_sunday.strftime('%Y%m%d')
            param_value = f'{{"statDate":"{stat_date}"}}'
            query_func = self.query_sol_weekly_data  # ç»‘å®šçƒ½ç«å‘¨æŠ¥æŸ¥è¯¢å‡½æ•°
        elif query_type == "è´§å¸èµ„äº§æŸ¥è¯¢":
            param_value = '{}'
            query_func = self.query_all_currencies  # ç»‘å®šè´§å¸èµ„äº§æŸ¥è¯¢å‡½æ•°ï¼ˆç‰¹æ®Šï¼šå¤šè¯·æ±‚ï¼‰
            # é¢„å®šä¹‰ä¸‰ç§è´§å¸IDä¸åç§°ï¼Œåç»­æŸ¥è¯¢ä½¿ç”¨
            self.currency_items = ['17020000010', '17888808889', '17888808888']  # å“ˆå¤«å¸, ä¸‰è§’åˆ¸, ä¸‰è§’å¸
        else:  # ç‰¹å‹¤å¤„çŠ¶æ€
            param_value = '{}'
            query_func = self.query_special_force_status  # ç»‘å®šç‰¹å‹¤å¤„çŠ¶æ€æŸ¥è¯¢å‡½æ•°
```
- **å‚æ•°ç²¾å‡†**ï¼šä¸åŒæŸ¥è¯¢ç±»å‹ä¼ é€’å¯¹åº”å‚æ•°ï¼Œå¦‚`resourceType`åŒºåˆ†`sol`/`mp`ï¼Œ`statDate`æŒ‡å®šå‘¨æŠ¥ç»Ÿè®¡æ—¥æœŸï¼Œå®Œå…¨åŒ¹é…æ¸¸æˆAPIè¦æ±‚ï¼›
- **å‘¨æœŸåŒ¹é…**ï¼šå‘¨æŠ¥æ•°æ®è®¡ç®—â€œæœ€è¿‘ä¸€ä¸ªå‘¨æ—¥â€ä½œä¸º`statDate`ï¼Œä¸æ¸¸æˆâ€œå‘¨ä¸€è‡³å‘¨æ—¥â€çš„ç»Ÿè®¡å‘¨æœŸä¸€è‡´ï¼Œç¡®ä¿æ•°æ®æ— åå·®ï¼›
- **ç‰¹æ®Šå¤„ç†**ï¼šè´§å¸èµ„äº§æŸ¥è¯¢é¢„å®šä¹‰ä¸‰ç§è´§å¸IDï¼Œä¸ºåç»­å¤šè¯·æ±‚é€»è¾‘åšå‡†å¤‡ã€‚

### 3. æ„é€ APIè¯·æ±‚å‚æ•°ï¼ˆparamsï¼‰
æ ¹æ®æŸ¥è¯¢ç±»å‹æ„é€ ä¸åŒçš„APIè¯·æ±‚å‚æ•°ï¼ˆ`iChartId`ã€`sIdeToken`ã€`method`ç­‰ï¼‰ï¼Œè¿™äº›å‚æ•°æ˜¯æ¸¸æˆAPIçš„æ ¸å¿ƒæ ‡è¯†ï¼Œå†³å®šè¯·æ±‚çš„æ¥å£ä¸æƒé™ï¼š
```python
        # æ„é€ APIè¯·æ±‚å‚æ•°ï¼ˆä¸åŒæŸ¥è¯¢ç±»å‹å¯¹åº”ä¸åŒå‚æ•°ï¼‰
        if query_type == "æ¯æ—¥å¯†ç ":
            url = "https://comm.ams.game.qq.com/ide/"
            params = {
                'iChartId': '316969',  # æ¯æ—¥å¯†ç æ¥å£æ ‡è¯†
                'iSubChartId': '316969',
                'sIdeToken': 'NoOapI',  # æ¯æ—¥å¯†ç æ¥å£ä»¤ç‰Œ
                'method': 'dfm/center.day.secret',  # æ¯æ—¥å¯†ç æ¥å£æ–¹æ³•
                'source': '2',
                'param': param_value
            }
        elif query_type == "æˆ˜åœºå‘¨æŠ¥æ•°æ®":
            url = "https://comm.ams.game.qq.com/ide/"
            params = {
                'iChartId': '316968',  # å‘¨æŠ¥æ¥å£æ ‡è¯†
                'iSubChartId': '316968',
                'sIdeToken': 'KfXJwH',  # å‘¨æŠ¥æ¥å£ä»¤ç‰Œ
                'source': '5',
                'sArea': '36',
                'method': 'dfm/weekly.mp.record',  # æˆ˜åœºå‘¨æŠ¥æ¥å£æ–¹æ³•
                'param': param_value
            }
        elif query_type == "çƒ½ç«å‘¨æŠ¥æ•°æ®":
            url = "https://comm.ams.game.qq.com/ide/"
            params = {
                'iChartId': '316968',
                'iSubChartId': '316968',
                'sIdeToken': 'KfXJwH',
                'source': '5',
                'sArea': '36',
                'method': 'dfm/weekly.sol.record',  # çƒ½ç«å‘¨æŠ¥æ¥å£æ–¹æ³•
                'param': param_value
            }
        elif query_type == "è´§å¸èµ„äº§æŸ¥è¯¢":
            url = "https://comm.ams.game.qq.com/ide/"
            params = {
                'iChartId': '319386',  # è´§å¸èµ„äº§æ¥å£æ ‡è¯†
                'iSubChartId': '319386',
                'sIdeToken': 'zMemOt',  # è´§å¸èµ„äº§æ¥å£ä»¤ç‰Œ
                'type': '3',
                'param': param_value
            }
        elif query_type == "ç‰¹å‹¤å¤„çŠ¶æ€":
            url = "https://comm.ams.game.qq.com/ide/"
            params = {
                'iChartId': '365589',  # ç‰¹å‹¤å¤„çŠ¶æ€æ¥å£æ ‡è¯†
                'iSubChartId': '365589',
                'sIdeToken': 'bQaMCQ',  # ç‰¹å‹¤å¤„çŠ¶æ€æ¥å£ä»¤ç‰Œ
                'source': '2',
                'param': param_value
            }
        else:  # çƒ½ç«åœ°å¸¦æ”¶ç›ŠTop3ã€å…¨é¢æˆ˜åœºæ•°æ®
            url = "https://comm.ams.game.qq.com/ide/"
            params = {
                'iChartId': '316969',
                'iSubChartId': '316969',
                'sIdeToken': 'NoOapI',
                'method': 'dfm/center.recent.detail',  # æ—¥å¸¸æ•°æ®æ¥å£æ–¹æ³•
                'source': '2',
                'param': param_value
            }
```
- **æ¥å£åŒ¹é…**ï¼šæ¯ä¸ªæŸ¥è¯¢ç±»å‹å¯¹åº”æ¸¸æˆå®˜æ–¹çš„ä¸“å±æ¥å£å‚æ•°ï¼ˆ`iChartId`ã€`sIdeToken`ã€`method`ï¼‰ï¼Œç¡®ä¿è¯·æ±‚åˆæ³•æœ‰æ•ˆï¼›
- **ç»Ÿä¸€URL**ï¼šæ‰€æœ‰è¯·æ±‚ä½¿ç”¨åŒä¸€åŸºç¡€URLï¼ˆ`https://comm.ams.game.qq.com/ide/`ï¼‰ï¼Œç¬¦åˆæ¸¸æˆAPIçš„è®¿é—®è§„åˆ™ã€‚

### 4. æ„é€ è¯·æ±‚å¤´ï¼ˆheadersï¼‰ä¸å‘é€è¯·æ±‚
è¯·æ±‚å¤´åŒ…å«Cookieä¿¡æ¯ï¼Œä¼ é€’ç”¨æˆ·èº«ä»½å‡­è¯ï¼Œç¡®ä¿APIè¯†åˆ«ç”¨æˆ·èº«ä»½ï¼š
```python
        # æ„é€ è¯·æ±‚å¤´ï¼Œé€šè¿‡Cookieä¼ é€’ç”¨æˆ·å‡­è¯
        headers = {
            'Content-Type': 'application/x-www-form-urlencoded',  # APIè¦æ±‚çš„è¡¨å•æ ¼å¼
            'Cookie': f'openid={self.openid}; acctype=qc; appid=101491592; access_token={self.access_token}'
        }
        
        # å‘é€POSTè¯·æ±‚ï¼Œè®¾ç½®è¶…æ—¶10ç§’ï¼Œé¿å…ç½‘ç»œå¼‚å¸¸å¯¼è‡´å¡æ­»
        response = requests.post(url, params=params, headers=headers, timeout=10)
        
        # è°ƒè¯•ä¿¡æ¯ï¼šæ‰“å°æŸ¥è¯¢ç±»å‹ã€HTTPçŠ¶æ€ç ã€å“åº”å‰200å­—ç¬¦ï¼Œä¾¿äºå¼€å‘è°ƒè¯•
        print(f"æŸ¥è¯¢ç±»å‹: {query_type}")
        print(f"HTTPçŠ¶æ€ç : {response.status_code}")
        print(f"å“åº”å†…å®¹å‰200å­—ç¬¦: {response.text[:200]}")
```
- **èº«ä»½éªŒè¯**ï¼šCookieåŒ…å«`openid`ï¼ˆç”¨æˆ·å”¯ä¸€æ ‡è¯†ï¼‰ã€`access_token`ï¼ˆè®¿é—®ä»¤ç‰Œï¼‰ã€`acctype=qc`ï¼ˆQQè´¦å·ç±»å‹ï¼‰ã€`appid=101491592`ï¼ˆæ¸¸æˆåº”ç”¨IDï¼‰ï¼Œå®Œå…¨æ¨¡æ‹Ÿæ¸¸æˆå®¢æˆ·ç«¯è¯·æ±‚ï¼Œç¡®ä¿èº«ä»½åˆæ³•ï¼›
- **è¶…æ—¶æ§åˆ¶**ï¼šè®¾ç½®`timeout=10`ï¼Œé¿å…ç½‘ç»œå¡é¡¿æˆ–æœåŠ¡å™¨æ— å“åº”å¯¼è‡´åº”ç”¨å¡æ­»ï¼›
- **è°ƒè¯•æ”¯æŒ**ï¼šæ‰“å°å…³é”®è°ƒè¯•ä¿¡æ¯ï¼Œä¾¿äºå¼€å‘äººå‘˜æ’æŸ¥APIè¯·æ±‚é—®é¢˜ï¼ˆå¦‚å‚æ•°é”™è¯¯ã€çŠ¶æ€ç å¼‚å¸¸ï¼‰ã€‚

### 5. å“åº”å¤„ç†ä¸ç»“æœå±•ç¤º
æ ¹æ®HTTPçŠ¶æ€ç ã€JSONè§£æç»“æœã€APIè¿”å›çŠ¶æ€ï¼Œåˆ†æ­¥éª¤å¤„ç†å“åº”ï¼Œæœ€ç»ˆè°ƒç”¨æ ¼å¼åŒ–æ–¹æ³•å±•ç¤ºç»“æœï¼š
#### ï¼ˆ1ï¼‰HTTPçŠ¶æ€ç åˆ¤æ–­
```python
        # å¤„ç†HTTPå“åº”
        if response.status_code == 200:  # HTTPè¯·æ±‚æˆåŠŸ
            try:
                # è§£æJSONå“åº”
                data = response.json()
            except json.JSONDecodeError as e:  # JSONè§£æå¤±è´¥ï¼ˆå¦‚å“åº”éJSONæ ¼å¼ï¼‰
                self.result_text.value = f"JSONè§£æé”™è¯¯: {str(e)}\n\nåŸå§‹å“åº”:\n{response.text}"
                self.status_label.text = "è§£æé”™è¯¯"
                return
```
- **è§£æå®¹é”™**ï¼šæ•è·`JSONDecodeError`ï¼Œæ˜¾ç¤ºåŸå§‹å“åº”æ–‡æœ¬ï¼Œå¸®åŠ©ç”¨æˆ·ä¸å¼€å‘äººå‘˜æ’æŸ¥é—®é¢˜ï¼ˆå¦‚APIè¿”å›HTMLé”™è¯¯é¡µï¼‰ã€‚

#### ï¼ˆ2ï¼‰APIè¿”å›çŠ¶æ€éªŒè¯
æ¸¸æˆAPIé€šè¿‡`ret`ä¸`iRet`å­—æ®µæ ‡è¯†è¯·æ±‚æ˜¯å¦æˆåŠŸï¼ˆå‡ä¸º0è¡¨ç¤ºæˆåŠŸï¼‰ï¼š
```python
            # éªŒè¯APIè¿”å›çŠ¶æ€ï¼ˆretä¸iRetå‡ä¸º0è¡¨ç¤ºæˆåŠŸï¼‰
            if data.get('ret') == 0 and data.get('iRet') == 0:
                jdata = data.get('jData', {})  # APIæ ¸å¿ƒæ•°æ®å­˜å‚¨åœ¨jDataä¸­
                data_content = jdata.get('data', {})  # å…·ä½“ä¸šåŠ¡æ•°æ®å­˜å‚¨åœ¨jData.dataä¸­
```

#### ï¼ˆ3ï¼‰ç‰¹æ®Šå¤„ç†ï¼šè´§å¸èµ„äº§æŸ¥è¯¢
è´§å¸èµ„äº§æŸ¥è¯¢éœ€å¾ªç¯è¯·æ±‚ä¸‰ç§è´§å¸æ•°æ®ï¼Œå•ç‹¬å¤„ç†ï¼š
```python
                # ç‰¹æ®Šå¤„ç†ï¼šè´§å¸èµ„äº§æŸ¥è¯¢ï¼ˆéœ€å¤šè¯·æ±‚ï¼‰
                if query_type == "è´§å¸èµ„äº§æŸ¥è¯¢":
                    # è°ƒç”¨query_all_currenciesæ–¹æ³•ï¼Œå¾ªç¯æŸ¥è¯¢ä¸‰ç§è´§å¸
                    result = self.query_all_currencies(url, params, headers)
                    self.result_text.value = result
                    # æ ¹æ®ç»“æœåˆ¤æ–­çŠ¶æ€
                    if "æŸ¥è¯¢å¤±è´¥" in result:
                        self.status_label.text = "æŸ¥è¯¢å¤±è´¥"
                    else:
                        self.status_label.text = f"æŸ¥è¯¢æˆåŠŸ - {datetime.now().strftime('%H:%M:%S')}"
```

#### ï¼ˆ4ï¼‰æ™®é€šæŸ¥è¯¢å¤„ç†
å…¶ä»–æŸ¥è¯¢ç±»å‹é€šè¿‡`data_content.code`éªŒè¯ä¸šåŠ¡çŠ¶æ€ï¼ˆ0è¡¨ç¤ºæˆåŠŸï¼‰ï¼Œè°ƒç”¨ç»‘å®šçš„æŸ¥è¯¢å‡½æ•°ä¸æ ¼å¼åŒ–æ–¹æ³•ï¼š
```python
                else:
                    # éªŒè¯ä¸šåŠ¡çŠ¶æ€ï¼ˆcode=0è¡¨ç¤ºä¸šåŠ¡å¤„ç†æˆåŠŸï¼‰
                    if data_content.get('code') == 0:
                        # è°ƒç”¨ç»‘å®šçš„æŸ¥è¯¢å‡½æ•°ï¼Œè·å–ä¸šåŠ¡æ•°æ®
                        result = query_func(data_content.get('data', {}))
                        # æ˜¾ç¤ºæ ¼å¼åŒ–åçš„ç»“æœ
                        self.result_text.value = result
                        # æ›´æ–°çŠ¶æ€æ ï¼Œæ·»åŠ æŸ¥è¯¢æ—¶é—´æˆ³
                        self.status_label.text = f"æŸ¥è¯¢æˆåŠŸ - {datetime.now().strftime('%H:%M:%S')}"
                    else:  # ä¸šåŠ¡å¤„ç†å¤±è´¥ï¼ˆå¦‚å‚æ•°é”™è¯¯ã€æƒé™ä¸è¶³ï¼‰
                        self.result_text.value = f"APIè¿”å›é”™è¯¯: {data_content.get('msg', 'æœªçŸ¥é”™è¯¯')}"
                        self.status_label.text = "æŸ¥è¯¢å¤±è´¥"
```
- **ä¸šåŠ¡å®¹é”™**ï¼šé€šè¿‡`data_content.code`éªŒè¯ä¸šåŠ¡çŠ¶æ€ï¼Œé¿å…ä¸šåŠ¡é”™è¯¯å¯¼è‡´åç»­å¤„ç†å´©æºƒï¼›
- **æ—¶é—´æˆ³**ï¼šæŸ¥è¯¢æˆåŠŸæ—¶æ·»åŠ æ—¶é—´æˆ³ï¼Œç”¨æˆ·å¯æ˜ç¡®çŸ¥æ™“æ•°æ®æ—¶æ•ˆæ€§ã€‚

#### ï¼ˆ5ï¼‰APIè¯·æ±‚å¤±è´¥å¤„ç†
```python
            else:  # APIè¿”å›çŠ¶æ€é”™è¯¯ï¼ˆå¦‚retâ‰ 0æˆ–iRetâ‰ 0ï¼‰
                self.result_text.value = f"è¯·æ±‚å¤±è´¥: {data.get('sMsg', 'æœªçŸ¥é”™è¯¯')}"
                self.status_label.text = "æŸ¥è¯¢å¤±è´¥"
        else:  # HTTPè¯·æ±‚å¤±è´¥ï¼ˆå¦‚404ã€500ï¼‰
            self.result_text.value = f"HTTPé”™è¯¯: {response.status_code}\nå“åº”å†…å®¹: {response.text}"
            self.status_label.text = "ç½‘ç»œé”™è¯¯"
```
- **é”™è¯¯æ˜ç¡®**ï¼šæ˜¾ç¤ºå…·ä½“HTTPçŠ¶æ€ç ä¸å“åº”å†…å®¹ï¼Œä¾¿äºæ’æŸ¥ç½‘ç»œé—®é¢˜ï¼ˆå¦‚DNSè§£æå¤±è´¥ã€æœåŠ¡å™¨ç»´æŠ¤ï¼‰ã€‚

### 6. å¼‚å¸¸æ•è·
```python
    except Exception as e:  # æ•è·æ‰€æœ‰æœªé¢„æ–™çš„å¼‚å¸¸ï¼ˆå¦‚ç½‘ç»œè¿æ¥è¶…æ—¶ã€å˜é‡æœªå®šä¹‰ï¼‰
        self.result_text.value = f"æŸ¥è¯¢è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯: {str(e)}"
        self.status_label.text = "é”™è¯¯"
```
- **å…¨å±€å®¹é”™**ï¼šé€šè¿‡é¡¶å±‚`try-except`æ•è·æ‰€æœ‰å¼‚å¸¸ï¼Œé¿å…åº”ç”¨å´©æºƒï¼ŒåŒæ—¶æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ï¼Œå¸®åŠ©é—®é¢˜æ’æŸ¥ã€‚


## ä¸ƒã€æ•°æ®æŸ¥è¯¢ä¸æ ¼å¼åŒ–æ–¹æ³•
ä»£ç ä¸­æ¯ä¸ªæŸ¥è¯¢ç±»å‹å¯¹åº”â€œæŸ¥è¯¢æ–¹æ³•ï¼ˆ`query_xxx`ï¼‰â€ä¸â€œæ ¼å¼åŒ–æ–¹æ³•ï¼ˆ`format_xxx`ï¼‰â€ï¼ŒæŸ¥è¯¢æ–¹æ³•æå–ä¸šåŠ¡æ•°æ®ï¼Œæ ¼å¼åŒ–æ–¹æ³•å°†æ•°æ®è½¬æ¢ä¸ºæ˜“è¯»æ–‡æœ¬ï¼Œä»¥ä¸‹è§£ææ ¸å¿ƒæ–¹æ³•ï¼š

### 1. æ¯æ—¥å¯†ç æŸ¥è¯¢ä¸æ ¼å¼åŒ–
#### ï¼ˆ1ï¼‰æŸ¥è¯¢æ–¹æ³•ï¼ˆquery_daily_secretï¼‰
ç®€å•æå–`data`ä¸­çš„å¯†ç åˆ—è¡¨ï¼Œæ— å¤æ‚å¤„ç†ï¼š
```python
def query_daily_secret(self, data):
    return self.format_daily_secret_result(data)
```

#### ï¼ˆ2ï¼‰æ ¼å¼åŒ–æ–¹æ³•ï¼ˆformat_daily_secret_resultï¼‰
å°†å¯†ç æ•°æ®æŒ‰â€œåœ°å›¾åç§°-å¯†ç â€æ ¼å¼å±•ç¤ºï¼Œæ·»åŠ ä½¿ç”¨è¯´æ˜ï¼Œæå‡å¯è¯»æ€§ï¼š
```python
def format_daily_secret_result(self, data):
    result = []
    if not data:  # æ— æ•°æ®æ—¶æç¤º
        return "æš‚æ— æ¯æ—¥å¯†ç æ•°æ®"
    
    # æ·»åŠ æŸ¥è¯¢æ—¶é—´ä¸æ ‡é¢˜
    current_time = datetime.now().strftime('%Y-%m-%d %H:%M:%S')
    result.append(f"=== æ¯æ—¥å¯†ç æŸ¥è¯¢æŠ¥å‘Š ===")
    result.append(f"æŸ¥è¯¢æ—¶é—´: {current_time}")
    result.append("")
    
    # æå–å¯†ç åˆ—è¡¨
    secret_list = data.get('list', [])
    if secret_list:
        result.append("=== ä»Šæ—¥åœ°å›¾å¯†ç  ===")
        result.append("-" * 40)
        
        # åœ°å›¾IDä¸åç§°æ˜ å°„ï¼ŒåŒ¹é…æ¸¸æˆå†…æ˜¾ç¤º
        map_names = {
            1: "é›¶å·å¤§å",
            2: "é•¿å¼“æºªè°·",
            3: "å·´å…‹ä»€",
            4: "èˆªå¤©åŸºåœ°",
            5: "æ½®æ±ç›‘ç‹±"
        }
        
        # éå†å¯†ç åˆ—è¡¨ï¼Œæ ¼å¼åŒ–æ¯ä¸ªåœ°å›¾çš„å¯†ç 
        for secret_info in secret_list:
            map_id = secret_info.get('mapID', 0)
            map_name = map_names.get(map_id, f"æœªçŸ¥åœ°å›¾({map_id})")  # æœªçŸ¥åœ°å›¾æ˜¾ç¤ºID
            secret = secret_info.get('secret', 'æœªçŸ¥')
            result.append(f"ã€{map_name}ã€‘")
            result.append(f"åœ°å›¾ID: {map_id}")
            result.append(f"ä»Šæ—¥å¯†ç : {secret}")
            result.append("")
        
        # æ·»åŠ ä½¿ç”¨è¯´æ˜ï¼Œå¸®åŠ©ç”¨æˆ·ç†è§£å¯†ç ç”¨é€”
        result.append("=== ä½¿ç”¨è¯´æ˜ ===")
        result.append("-" * 40)
        result.append("â€¢ å¯†ç å¯ç”¨äºè¿›å…¥å¯¹åº”åœ°å›¾çš„ç‰¹æ®ŠåŒºåŸŸ")
        result.append("â€¢ æ¯æ—¥å¯†ç ä¼šåœ¨æœåŠ¡å™¨æ—¶é—´00:00åˆ·æ–°")
        result.append("â€¢ ä¸åŒåœ°å›¾çš„å¯†ç å¯èƒ½ä¸åŒ")
        result.append("â€¢ è¯·å¦¥å–„ä¿ç®¡å¯†ç ï¼Œé¿å…æ³„éœ²")
        result.append("")
        result.append("ğŸ’¡ æç¤º: ç‚¹å‡»å¯†ç åŒºåŸŸå¯ä»¥å¤åˆ¶å¯†ç å†…å®¹")
    else:  # æ— å¯†ç æ•°æ®æ—¶æç¤ºå¯èƒ½åŸå› 
        result.append("ä»Šæ—¥æš‚æ— åœ°å›¾å¯†ç ä¿¡æ¯")
        result.append("")
        result.append("å¯èƒ½åŸå› :")
        result.append("- æœåŠ¡å™¨ç»´æŠ¤ä¸­")
        result.append("- å¯†ç å°šæœªåˆ·æ–°")
        result.append("- ç½‘ç»œè¿æ¥é—®é¢˜")
    
    return "\n".join(result)  # åˆ—è¡¨è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œä¾¿äºæ˜¾ç¤º
```
- **åœ°å›¾æ˜ å°„**ï¼šå°†åœ°å›¾IDè½¬æ¢ä¸ºæ¸¸æˆå†…åç§°ï¼ˆå¦‚1â†’â€œé›¶å·å¤§åâ€ï¼‰ï¼Œç”¨æˆ·æ— éœ€è®°å¿†IDï¼Œæå‡æ˜“ç”¨æ€§ï¼›
- **ä½¿ç”¨å¼•å¯¼**ï¼šæ·»åŠ ä½¿ç”¨è¯´æ˜ä¸æç¤ºï¼Œæ–°ç”¨æˆ·å¯å¿«é€Ÿç†è§£å¯†ç ç”¨é€”ä¸åˆ·æ–°è§„åˆ™ï¼›
- **å¼‚å¸¸æç¤º**ï¼šæ— æ•°æ®æ—¶åˆ—å‡ºå¯èƒ½åŸå› ï¼Œå¸®åŠ©ç”¨æˆ·æ’æŸ¥é—®é¢˜ï¼Œé™ä½æ“ä½œç„¦è™‘ã€‚

### 2. è´§å¸èµ„äº§æŸ¥è¯¢ä¸æ ¼å¼åŒ–
è´§å¸èµ„äº§æŸ¥è¯¢éœ€å¾ªç¯è¯·æ±‚ä¸‰ç§è´§å¸æ•°æ®ï¼Œæ˜¯æœ€å¤æ‚çš„æŸ¥è¯¢ç±»å‹ä¹‹ä¸€ï¼š

#### ï¼ˆ1ï¼‰æŸ¥è¯¢æ–¹æ³•ï¼ˆquery_all_currenciesï¼‰
```python
def query_all_currencies(self, url, params, headers):
    result = []
    # æ·»åŠ æŸ¥è¯¢æ—¶é—´ä¸æ ‡é¢˜
    current_time = datetime.now().strftime('%Y-%m-%d %H:%M:%S')
    result.append(f"=== è´§å¸èµ„äº§æŸ¥è¯¢æŠ¥å‘Š ===")
    result.append(f"æŸ¥è¯¢æ—¶é—´: {current_time}")
    result.append("")
    
    # å®šä¹‰ä¸‰ç§è´§å¸çš„IDä¸åç§°æ˜ å°„
    currency_items = [
        ('17020000010', 'å“ˆå¤«å¸'),
        ('17888808889', 'ä¸‰è§’åˆ¸'),
        ('17888808888', 'ä¸‰è§’å¸')
    ]
    
    total_assets = 0  # è®¡ç®—æ€»èµ„äº§ï¼ˆä»¥å“ˆå¤«å¸ä¸ºåŸºå‡†ï¼‰
    
    # å¾ªç¯æŸ¥è¯¢æ¯ç§è´§å¸
    for item_id, currency_name in currency_items:
        try:
            # å¤åˆ¶å‚æ•°å¹¶ä¿®æ”¹itemå­—æ®µï¼ˆæŒ‡å®šè´§å¸IDï¼‰
            query_params = params.copy()
            query_params['item'] = item_id
            
            # å‘é€POSTè¯·æ±‚ï¼Œè¶…æ—¶10ç§’
            response = requests.post(url, params=query_params, headers=headers, timeout=10)
            
            if response.status_code == 200:
                data = response.json()
                # éªŒè¯APIçŠ¶æ€
                if data.get('ret') == 0 and data.get('iRet') == 0:
                    jdata = data.get('jData', {})
                    data_content = jdata.get('data', [])
                    if isinstance(data_content, list) and len(data_content) > 0:
                        currency_data = data_content[0]
                        total_money = currency_data.get('totalMoney', '0')
                        money_amount = int(total_money)
                        total_assets += money_amount  # ç´¯åŠ æ€»èµ„äº§
                        
                        # æ ¼å¼åŒ–å½“å‰è´§å¸ä¿¡æ¯
                        result.append(f"=== {currency_name} ===")
                        result.append(f"æ•°é‡: {money_amount:,}")  # åƒä½åˆ†éš”ç¬¦ï¼Œæå‡å¯è¯»æ€§
                        
                        # æ ¹æ®æ•°é‡æ·»åŠ èµ„äº§çŠ¶æ€è¯„ä¼°ï¼Œå¸®åŠ©ç”¨æˆ·åˆ¤æ–­èµ„äº§æ°´å¹³
                        if money_amount > 1000000:
                            result.append("ğŸ’° èµ„äº§çŠ¶æ€: å¯Œæœ‰")
                        elif money_amount > 500000:
                            result.append("ğŸ’µ èµ„äº§çŠ¶æ€: å°åº·")
                        elif money_amount > 100000:
                            result.append("ğŸ’¸ èµ„äº§çŠ¶æ€: ä¸€èˆ¬")
                        else:
                            result.append("ğŸ’³ èµ„äº§çŠ¶æ€: éœ€è¦ç§¯ç´¯")
                        result.append("")
                    else:
                        result.append(f"{currency_name}: æ•°æ®æ ¼å¼å¼‚å¸¸")
                        result.append("")
                else:
                    result.append(f"{currency_name}: æŸ¥è¯¢å¤±è´¥ - {data.get('sMsg', 'æœªçŸ¥é”™è¯¯')}")
                    result.append("")
            else:
                result.append(f"{currency_name}: HTTPé”™è¯¯ - {response.status_code}")
                result.append("")
        except Exception as e:
            result.append(f"{currency_name}: æŸ¥è¯¢é”™è¯¯ - {str(e)}")
            result.append("")
    
    # æ·»åŠ æ€»èµ„äº§ç»Ÿè®¡ä¸æ•´ä½“çŠ¶æ€è¯„ä¼°
    result.append("=== æ€»èµ„äº§ç»Ÿè®¡ ===")
    result.append(f"ä¸‰ç§è´§å¸æ€»ä»·å€¼: {total_assets:,} å“ˆå¤«å¸")
    result.append("")
    
    if total_assets > 30000000:
        result.append("ğŸ’° æ€»ä½“èµ„äº§çŠ¶æ€: éå¸¸å¯Œæœ‰")
    elif total_assets > 15000000:  # æ­¤å¤„åŸä»£ç å¯èƒ½å­˜åœ¨ç¬”è¯¯ï¼Œåº”ä¸º1500000ï¼ˆ150ä¸‡ï¼‰ï¼ŒæŒ‰åŸä»£ç ä¿ç•™
        result.append("ğŸ’µ æ€»ä½“èµ„äº§çŠ¶æ€: å¯Œæœ‰")
    elif total_assets > 5000000:  # æ­¤å¤„åŸä»£ç å¯èƒ½å­˜åœ¨ç¬”è¯¯ï¼Œåº”ä¸º500000ï¼ˆ50ä¸‡ï¼‰ï¼ŒæŒ‰åŸä»£ç ä¿ç•™
        result.append("ğŸ’¸ æ€»ä½“èµ„äº§çŠ¶æ€: å°åº·")
    else:
        result.append("ğŸ’³ æ€»ä½“èµ„äº§çŠ¶æ€: éœ€è¦ç§¯ç´¯")
    
    return "\n".join(result)
```
- **å¤šè¯·æ±‚å¤„ç†**ï¼šå¾ªç¯æŸ¥è¯¢ä¸‰ç§è´§å¸ï¼Œæ¯æ¬¡ä¿®æ”¹`item`å‚æ•°æŒ‡å®šè´§å¸IDï¼Œå®ç°â€œä¸€ç«™å¼â€æŸ¥è¯¢ï¼›
- **èµ„äº§è¯„ä¼°**ï¼šæ ¹æ®è´§å¸æ•°é‡æ·»åŠ â€œå¯Œæœ‰/å°åº·/ä¸€èˆ¬â€ç­‰çŠ¶æ€æ ‡ç­¾ï¼Œå¸®åŠ©ç”¨æˆ·å¿«é€Ÿåˆ¤æ–­èµ„äº§æ°´å¹³ï¼›
- **æ€»èµ„äº§ç»Ÿè®¡**ï¼šç´¯åŠ ä¸‰ç§è´§å¸æ•°é‡ï¼Œæä¾›æ•´ä½“èµ„äº§è§†è§’ï¼Œæ»¡è¶³ç”¨æˆ·èµ„äº§ç®¡ç†éœ€æ±‚ã€‚

### 3. çƒ½ç«å‘¨æŠ¥æ•°æ®æ ¼å¼åŒ–ï¼ˆformat_sol_weekly_resultï¼‰
çƒ½ç«å‘¨æŠ¥æ•°æ®ç»´åº¦æœ€ä¸°å¯Œï¼Œæ ¼å¼åŒ–æ–¹æ³•æ¶µç›–åŸºç¡€ç»Ÿè®¡ã€ç»æµæ•°æ®ã€æˆ˜æ–—æ•°æ®ã€ç‰¹æ®Šæ•°æ®ç­‰ï¼Œæ ¸å¿ƒé€»è¾‘å¦‚ä¸‹ï¼š
```python
def format_sol_weekly_result(self, data):
    result = []
    if not data:  # æ— æ•°æ®æ—¶æç¤º
        return "æœ¬å‘¨æš‚æ— çƒ½ç«å‘¨æŠ¥æ•°æ®"
    
    # è®¡ç®—ç»Ÿè®¡å‘¨æœŸï¼ˆå‘¨ä¸€è‡³å‘¨æ—¥ï¼‰
    today = datetime.now()
    days_since_sunday = today.weekday() + 1
    last_sunday = today - timedelta(days=days_since_sunday % 7)
    week_start = last_sunday - timedelta(days=6)
    result.append(f"=== çƒ½ç«å‘¨æŠ¥æ•°æ® (ç»Ÿè®¡å‘¨æœŸ: {week_start.strftime('%Y-%m-%d')} è‡³ {last_sunday.strftime('%Y-%m-%d')}) ===")
    result.append("")
    
    # 1. åŸºç¡€ç»Ÿè®¡ï¼ˆå¯¹å±€æ•°ã€æ’¤ç¦»ç‡ã€åœ¨çº¿æ—¶é•¿ç­‰ï¼‰
    total_sol_num = int(data.get('total_sol_num', 0))  # æœ¬å‘¨å¯¹å±€æ•°
    total_exacuation_num = int(data.get('total_exacuation_num', 0))  # æ’¤ç¦»æˆåŠŸæ•°
    total_Quest_num = int(data.get('total_Quest_num', 0))  # å®Œæˆä»»åŠ¡æ•°
    total_Online_Time = int(data.get('total_Online_Time', 0))  # æ€»åœ¨çº¿æ—¶é•¿ï¼ˆç§’ï¼‰
    
    # è®¡ç®—è¡ç”ŸæŒ‡æ ‡
    evacuation_rate = (total_exacuation_num / total_sol_num * 100) if total_sol_num > 0 else 0  # æ’¤ç¦»ç‡
    avg_online_time = total_Online_Time / total_sol_num if total_sol_num > 0 else 0  # å¹³å‡åœ¨çº¿æ—¶é•¿
    hours = total_Online_Time // 3600  # æ€»åœ¨çº¿æ—¶é•¿ï¼ˆå°æ—¶ï¼‰
    minutes = (total_Online_Time % 3600) // 60  # æ€»åœ¨çº¿æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰
    
    result.append("=== åŸºç¡€ç»Ÿè®¡ ===")
    result.append(f"æœ¬å‘¨å¯¹å±€æ•°: {total_sol_num:,}")
    result.append(f"æ’¤ç¦»æˆåŠŸæ•°: {total_exacuation_num:,}")
    result.append(f"æ’¤ç¦»ç‡: {evacuation_rate:.1f}%")  # ä¿ç•™1ä½å°æ•°ï¼Œæå‡ç²¾åº¦
    result.append(f"å®Œæˆä»»åŠ¡æ•°: {total_Quest_num:,}")
    result.append(f"æ€»åœ¨çº¿æ—¶é•¿: {total_Online_Time:,}ç§’ ({hours}å°æ—¶{minutes}åˆ†é’Ÿ)")  # è½¬æ¢ä¸ºå°æ—¶+åˆ†é’Ÿ
    result.append(f"å¹³å‡åœ¨çº¿æ—¶é•¿: {avg_online_time:.1f}ç§’")
    result.append("")
    
    # 2. ç»æµæ•°æ®ï¼ˆæ”¶ç›Šã€æˆæœ¬ã€åˆ©æ¶¦ç­‰ï¼‰
    gained_price = int(data.get('Gained_Price', 0))  # æ€»å¸¦å‡ºå“ˆå¤«å¸
    consume_price = int(data.get('consume_Price', 0))  # æ€»å¸¦å…¥å“ˆå¤«å¸
    rise_price = int(data.get('rise_Price', 0))  # æ€»åˆ©æ¶¦
    total_price = data.get('Total_Price', '')  # æ¯æ—¥ä»“åº“ä»·å€¼
    
    # è®¡ç®—è¡ç”ŸæŒ‡æ ‡
    avg_gain = gained_price / total_sol_num if total_sol_num > 0 else 0  # å¹³å‡æ¯å±€æ”¶ç›Š
    profit_margin = (rise_price / consume_price * 100) if consume_price > 0 else 0  # åˆ©æ¶¦ç‡
    
    result.append("=== ç»æµæ•°æ® ===")
    result.append(f"æœ¬å‘¨æ€»å¸¦å‡ºå“ˆå¤«å¸: {gained_price:,}")
    result.append(f"æœ¬å‘¨æ€»å¸¦å…¥å“ˆå¤«å¸: {consume_price:,}")
    result.append(f"æœ¬å‘¨æ€»åˆ©æ¶¦: {rise_price:,}")
    result.append(f"å¹³å‡æ¯å±€æ”¶ç›Š: {avg_gain:,.0f}")  # å–æ•´ï¼Œç¬¦åˆè´§å¸å•ä½
    result.append(f"åˆ©æ¶¦ç‡: {profit_margin:.1f}%")
    result.append("")
    
    # è§£ææ¯æ—¥ä»“åº“ä»·å€¼ï¼ˆæ ¼å¼ï¼šå‘¨ä¸€-20240501-100000,å‘¨äºŒ-20240502-150000...ï¼‰
    if total_price:
        try:
            price_entries = total_price.split(',')
            result.append("=== æ¯æ—¥ä»“åº“ä»·å€¼ ===")
            for entry in price_entries:
                if '-' in entry:
                    parts = entry.split('-')
                    if len(parts) >= 3:
                        day = parts[0]
                        date = parts[1]
                        value = parts[2]
                        result.append(f"{day} ({date}): {int(value):,}")
        except:
            pass  # è§£æå¤±è´¥ä¸å½±å“å…¶ä»–æ•°æ®
        result.append("")
    
    # 3. æˆ˜æ–—æ•°æ®ï¼ˆå‡»æ€ã€æ­»äº¡ã€KDæ¯”ç­‰ï¼‰
    total_kill_count = int(data.get('total_Kill_Count', 0))  # æ€»å‡»æ€æ•°
    total_kill_player = int(data.get('total_Kill_Player', 0))  # å‡»è´¥å¹²å‘˜æ•°
    total_kill_ai = int(data.get('total_Kill_AI', 0))  # å‡»æ€AIæ•°
    total_kill_boss = int(data.get('total_Kill_Boss', 0))  # å‡»æ€BOSSæ•°
    total_death_count = int(data.get('total_Death_Count', 0))  # æ­»äº¡æ¬¡æ•°
    total_rescue_num = int(data.get('total_Rescue_num', 0))  # æ•‘æ´æ¬¡æ•°
    
    # è®¡ç®—è¡ç”ŸæŒ‡æ ‡
    kd_ratio = total_kill_count / total_death_count if total_death_count > 0 else total_kill_count  # KDæ¯”
    survival_rate = ((total_sol_num - total_death_count) / total_sol_num * 100) if total_sol_num > 0 else 0  # ç”Ÿå­˜ç‡
    
    result.append("=== æˆ˜æ–—æ•°æ® ===")
    result.append(f"æ€»å‡»æ€æ•°: {total_kill_count:,}")
    result.append(f"å‡»è´¥å¹²å‘˜æ•°: {total_kill_player:,}")
    result.append(f"å‡»æ€AIæ•°: {total_kill_ai:,}")
    result.append(f"å‡»æ€BOSSæ•°: {total_kill_boss:,}")
    result.append(f"æ­»äº¡æ¬¡æ•°: {total_death_count:,}")
    result.append(f"KDæ¯”: {kd_ratio:.2f}")  # ä¿ç•™2ä½å°æ•°ï¼Œç¬¦åˆæ¸¸æˆæ•°æ®ä¹ æƒ¯
    result.append(f"ç”Ÿå­˜ç‡: {survival_rate:.1f}%")
    result.append(f"æ•‘æ´æ¬¡æ•°: {total_rescue_num:,}")
    result.append("")
    
    # 4. ç‰¹æ®Šæ•°æ®ï¼ˆç™¾ä¸‡æ’¤ç¦»ã€è¢«é³„é±¼æ€æ­»ã€æœç´¢é¸Ÿå·¢ç­‰ï¼‰
    gained_price_overmillion_num = int(data.get('GainedPrice_overmillion_num', 0))  # ç™¾ä¸‡æ’¤ç¦»åœºæ¬¡
    teammate_price_overzero_num = int(data.get('TeammatePrice_overzero_num', 0))  # é˜Ÿå‹ä»·æ ¼ä¸ºæ­£æ¬¡æ•°
    kill_by_crocodile_num = int(data.get('Kill_ByCrocodile_num', 0))  # è¢«é³„é±¼æ€æ­»æ¬¡æ•°
    search_birdsnest_num = int(data.get('search_Birdsnest_num', 0))  # æœç´¢é¸Ÿå·¢æ•°
    mandel_brick_num = int(data.get('Mandel_brick_num', 0))  # æ›¼å¾·å°”ç –ç ´è¯‘æ•°
    use_keycard_num = int(data.get('use_Keycard_num', 0))  # æ¶ˆè€—é’¥åŒ™æ•°
    total_mileage = int(data.get('Total_Mileage', 0))  # æ€»é‡Œç¨‹ï¼ˆç±³ï¼‰
    rank_score = int(data.get('Rank_Score', 0))  # æ’ä½åˆ†æ•°
    
    result.append("=== ç‰¹æ®Šæ•°æ® ===")
    result.append(f"ç™¾ä¸‡æ’¤ç¦»åœºæ¬¡: {gained_price_overmillion_num:,}")
    result.append(f"é˜Ÿå‹ä»·æ ¼ä¸ºæ­£æ¬¡æ•°: {teammate_price_overzero_num:,}")
    result.append(f"è¢«é³„é±¼æ€æ­»æ¬¡æ•°: {kill_by_crocodile_num:,}")
    result.append(f"æœç´¢é¸Ÿå·¢æ•°: {search_birdsnest_num:,}")
    result.append(f"æ›¼å¾·å°”ç –ç ´è¯‘æ•°: {mandel_brick_num:,}")
    result.append(f"æ¶ˆè€—é’¥åŒ™æ•°: {use_keycard_num:,}")
    result.append(f"æ€»é‡Œç¨‹: {total_mileage:,}ç±³")
    result.append(f"æ’ä½åˆ†æ•°: {rank_score:,}")
    result.append("")
    
    # 5. å¹²å‘˜ä½¿ç”¨æƒ…å†µï¼ˆè§£ææ ¼å¼ï¼š{'ArmedForceId':40005,'inum':2}#{'ArmedForceId':20004,'inum':10}...ï¼‰
    armed_force_info = data.get('total_ArmedForceId_num', '')
    armed_force_data = []
    if armed_force_info and armed_force_info.startswith('{'):
        try:
            entries = armed_force_info.split('#')
            for entry in entries:
                if entry.startswith('{') and entry.endswith('}'):
                    parts = entry.strip('{}').split(',')
                    force_id = parts[0].split(':')[1] if len(parts) > 0 else 'æœªçŸ¥'
                    inum = parts[1].split(':')[1] if len(parts) > 1 else '0'
                    armed_force_data.append((force_id, int(inum)))
        except:
            pass
    
    # å¹²å‘˜IDä¸åç§°æ˜ å°„ï¼ŒåŒ¹é…æ¸¸æˆå†…æ˜¾ç¤º
    force_map = {
        '10007': 'çº¢ç‹¼', '10010': 'å¨é¾™', '10011': 'æ— å',
        '20003': 'èœ‚åŒ»', '20004': 'è›Š', '30008': 'ç‰§ç¾Šäºº',
        '30011': 'æ¯”ç‰¹', '40005': 'éœ²å¨œ', '40010': 'éª‡çˆª', '10012': 'ç–¾é£'
    }
    
    if armed_force_data:
        result.append("=== å¹²å‘˜ä½¿ç”¨æƒ…å†µ ===")
        # æŒ‰ä½¿ç”¨åœºæ¬¡é™åºæ’åˆ—ï¼Œæ˜¾ç¤ºä½¿ç”¨æœ€å¤šçš„å¹²å‘˜
        for force_id, inum in sorted(armed_force_data, key=lambda x: x[1], reverse=True):
            force_name = force_map.get(force_id, f'å¹²å‘˜{force_id}')
            result.append(f"{force_name} (ID:{force_id}): {inum}åœº")
        result.append("")
    
    # 6. åœ°å›¾åˆ†å¸ƒï¼ˆè§£ææ ¼å¼ï¼š{'MapId':2202,'inum':6}#{'MapId':1901,'inum':5}...ï¼‰
    map_info = data.get('total_mapid_num', '')
    map_data = []
    if map_info and map_info.startswith('{'):
        try:
            map_entries = map_info.split('#')
            for entry in map_entries:
                if entry.startswith('{') and entry.endswith('}'):
                    parts = entry.strip('{}').split(',')
                    map_id = parts[0].split(':')[1] if len(parts) > 0 else 'æœªçŸ¥'
                    inum = parts[1].split(':')[1] if len(parts) > 1 else '0'
                    map_data.append((map_id, int(inum)))
        except:
            pass
    
    if map_data:
        result.append("=== åœ°å›¾åˆ†å¸ƒ ===")
        # æŒ‰åœºæ¬¡é™åºæ’åˆ—ï¼Œæ˜¾ç¤ºå‰5ä¸ªé«˜é¢‘åœ°å›¾
        for map_id, inum in sorted(map_data, key=lambda x: x[1], reverse=True)[:5]:
            result.append(f"åœ°å›¾ID {map_id}: {inum}åœº")
        result.append("")
    
    # 7. é«˜ä»·å€¼ç‰©å“ï¼ˆè§£ææ ¼å¼ï¼š{'itemid':13120000256,'inum':1,'auctontype':é…ä»¶,'quality':5.0,'iPrice':25534.0}...ï¼‰
    carry_out_highprice_list = data.get('CarryOut_highprice_list', '')
    if carry_out_highprice_list and len(carry_out_highprice_list) > 10:
        try:
            items = carry_out_highprice_list.split('#')
            if items:
                result.append("=== æœ¬å‘¨å¸¦å‡ºé«˜ä»·å€¼ç‰©å“ (å‰10ä¸ª) ===")
                # æ˜¾ç¤ºå‰10ä¸ªé«˜ä»·å€¼ç‰©å“
                for i, item in enumerate(items[:10], 1):
                    if item.startswith('{') and item.endswith('}'):
                        parts = item.strip('{}').split(',')
                        item_id = ''
                        price = ''
                        for part in parts:
                            if 'itemid:' in part:
                                item_id = part.split(':')[1]
                            elif 'iPrice:' in part:
                                price = part.split(':')[1]
                        if item_id and price:
                            result.append(f"{i}. ç‰©å“ID: {item_id}, ä»·å€¼: {float(price):,.0f}")
        except:
            pass
        result.append("")
    
    return "\n".join(result)
```
- **ç»´åº¦å…¨é¢**ï¼šè¦†ç›–åŸºç¡€ç»Ÿè®¡ã€ç»æµæ•°æ®ã€æˆ˜æ–—æ•°æ®ã€ç‰¹æ®Šæ•°æ®ã€å¹²å‘˜ä½¿ç”¨ã€åœ°å›¾åˆ†å¸ƒã€é«˜ä»·å€¼ç‰©å“7å¤§ç»´åº¦ï¼Œæ»¡è¶³ç©å®¶æ·±åº¦åˆ†æéœ€æ±‚ï¼›
- **è¡ç”ŸæŒ‡æ ‡**ï¼šè®¡ç®—æ’¤ç¦»ç‡ã€KDæ¯”ã€åˆ©æ¶¦ç‡ç­‰è¡ç”ŸæŒ‡æ ‡ï¼Œå¸®åŠ©ç©å®¶æŒ–æ˜æ•°æ®èƒŒåçš„æ¸¸æˆè¡¨ç°ï¼›
- **æ•°æ®è§£æ**ï¼šå¤„ç†å¤šç§éæ ‡å‡†JSONæ ¼å¼ï¼ˆå¦‚`#`åˆ†éš”çš„å­—ç¬¦ä¸²ï¼‰ï¼Œé€šè¿‡`try-except`ç¡®ä¿è§£æå¤±è´¥ä¸å½±å“å…¶ä»–æ•°æ®ï¼›
- **ç”¨æˆ·å‹å¥½**ï¼šå¹²å‘˜IDæ˜ å°„ä¸ºæ¸¸æˆå†…åç§°ï¼Œæ—¶é—´è½¬æ¢ä¸ºâ€œå°æ—¶+åˆ†é’Ÿâ€ï¼Œæ•°å€¼æ·»åŠ åƒä½åˆ†éš”ç¬¦ï¼Œæå‡æ•°æ®å¯è¯»æ€§ã€‚


## å…«ã€è¾…åŠ©åŠŸèƒ½ï¼šè·å–å¸®åŠ©ï¼ˆget_helpæ–¹æ³•ï¼‰
`get_help`æ–¹æ³•è´Ÿè´£è·å–å¸®åŠ©æ–‡æ¡£å¹¶å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œæä¾›ç”¨æˆ·æ“ä½œæŒ‡å¼•ä¸é—®é¢˜æ’æŸ¥æ–¹æ¡ˆï¼Œæ ¸å¿ƒé€»è¾‘å¦‚ä¸‹ï¼š
```python
def get_help(self, widget):
    try:
        # æ›´æ–°çŠ¶æ€æ ï¼Œå‘ŠçŸ¥ç”¨æˆ·æ­£åœ¨è·å–å¸®åŠ©
        self.status_label.text = "æ­£åœ¨è·å–å¸®åŠ©æ–‡æ¡£..."
        
        # å¸®åŠ©æ–‡æ¡£URLï¼ˆè…¾è®¯æ–‡æ¡£ï¼‰
        help_url = "https://docs.qq.com/document/DS2hWc29pSGVIa3dM"
        # å‘é€GETè¯·æ±‚è·å–æ–‡æ¡£é¡µé¢ï¼Œè¶…æ—¶15ç§’
        response = requests.get(help_url, timeout=15)
        
        if response.status_code == 200:  # HTTPè¯·æ±‚æˆåŠŸ
            try:
                # æå–é¡µé¢å†…å®¹ä¸æ ‡é¢˜
                page_content = response.text
                # æ­£åˆ™åŒ¹é…HTMLæ ‡é¢˜ï¼ˆ<title>æ ‡ç­¾å†…å®¹ï¼‰
                import re
                title_match = re.search(r'<title[^>]*>([^<]+)</title>', page_content, re.IGNORECASE)
                title = title_match.group(1).strip() if title_match else "DFMæŸ¥è¯¢å·¥å…·å¸®åŠ©æ–‡æ¡£"
                
                # æ„å»ºå¸®åŠ©æ–‡æ¡£å†…å®¹ï¼Œæ¶µç›–ä½¿ç”¨è¯´æ˜ã€æŸ¥è¯¢ç±»å‹ã€åŠŸèƒ½ç‰¹æ€§ã€å¸¸è§é—®é¢˜
                help_content = f"{title}\n\n"
                help_content += f"æ–‡æ¡£é“¾æ¥: {help_url}\n\n"
                help_content += "=== DFMæŸ¥è¯¢å·¥å…·ä½¿ç”¨è¯´æ˜ ===\n\n"
                help_content += "1. ç”¨æˆ·é…ç½®ï¼š\n"
                help_content += "   - è¾“å…¥æ‚¨çš„OpenIDå’ŒAccess Token\n"
                help_content += "   - ç‚¹å‡»ä¿å­˜æŒ‰é’®ä¿å­˜é…ç½®\n\n"
                help_content += "2. æŸ¥è¯¢åŠŸèƒ½ï¼š\n"
                help_content += "   - é€‰æ‹©æŸ¥è¯¢ç±»å‹\n"
                help_content += "   - ç‚¹å‡»æŸ¥è¯¢æ•°æ®è·å–ç»“æœ\n\n"
                help_content += "3. æ”¯æŒçš„æŸ¥è¯¢ç±»å‹ï¼š\n"
                help_content += "   - æ¯æ—¥å¯†ç ï¼šè·å–å½“æ—¥åœ°å›¾å¯†ç \n"
                help_content += "   - çƒ½ç«åœ°å¸¦æ”¶ç›ŠTop3ï¼šæŸ¥çœ‹æ˜¨æ—¥é«˜ä»·å€¼ç‰©å“\n"
                help_content += "   - å…¨é¢æˆ˜åœºæ•°æ®ï¼šæŸ¥çœ‹MPæ¨¡å¼æˆ˜ç»©\n"
                help_content += "   - æˆ˜åœºå‘¨æŠ¥æ•°æ®ï¼šæŸ¥çœ‹æœ¬å‘¨MPç»Ÿè®¡\n"
                help_content += "   - çƒ½ç«å‘¨æŠ¥æ•°æ®ï¼šæŸ¥çœ‹æœ¬å‘¨Solç»Ÿè®¡\n"
                help_content += "   - ç‰¹å‹¤å¤„çŠ¶æ€ï¼šæŸ¥çœ‹ç‰¹å‹¤å¤„è®¾æ–½çŠ¶æ€\n"
                help_content += "   - è´§å¸èµ„äº§æŸ¥è¯¢ï¼šæŸ¥çœ‹æ¸¸æˆè´§å¸ä½™é¢\n\n"
                help_content += "4. åŠŸèƒ½ç‰¹æ€§ï¼š\n"
                help_content += "   - å¯æŠ˜å çš„ç”¨æˆ·é…ç½®åŒºåŸŸ\n"
                help_content += "   - è‡ªåŠ¨ç‰©å“åç§°è¯†åˆ«\n"
                help_content += "   - è¯¦ç»†çš„æ•°æ®æ ¼å¼åŒ–æ˜¾ç¤º\n"
                help_content += "   - é”™è¯¯å¤„ç†å’ŒçŠ¶æ€æç¤º\n\n"
                help_content += "5. å¸¸è§é—®é¢˜ï¼š\n"
                help_content += "   - å¦‚æŸ¥è¯¢å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥\n"
                help_content += "   - å¦‚æ˜¾ç¤ºé…ç½®é”™è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥å‡­è¯\n"
                help_content += "   - å¯æŠ˜å é…ç½®åŒºåŸŸä»¥è·å¾—æ›´å¤§æŸ¥çœ‹ç©ºé—´\n\n"
                help_content += f"å®Œæ•´æ–‡æ¡£è¯·è®¿é—®ï¼š{help_url}"
            
            except Exception as extract_error:  # æå–æ ‡é¢˜æˆ–æ„å»ºå†…å®¹å¤±è´¥
                # æä¾›åŸºç¡€å¸®åŠ©å†…å®¹ï¼Œç¡®ä¿ç”¨æˆ·ä»èƒ½è·å–æ ¸å¿ƒä¿¡æ¯
                help_content = "DFMæŸ¥è¯¢å·¥å…·å¸®åŠ©æ–‡æ¡£\n\nè·å–è¯¦ç»†æ–‡æ¡£ï¼š\n" + help_url + "\n\næ­¤å·¥å…·ç”¨äºæŸ¥è¯¢çƒ½ç«åœ°å¸¦æ¸¸æˆæ•°æ®ï¼Œæ”¯æŒå¤šç§æŸ¥è¯¢ç±»å‹ã€‚å¦‚éœ€è¯¦ç»†ä½¿ç”¨è¯´æ˜ï¼Œè¯·è®¿é—®ä¸Šè¿°é“¾æ¥ã€‚"
            
            # å¤åˆ¶å¸®åŠ©å†…å®¹åˆ°å‰ªè´´æ¿
            try:
                pyperclip.copy(help_content)
                # æ›´æ–°çŠ¶æ€æ ä¸ç»“æœæ–‡æœ¬ï¼Œå‘ŠçŸ¥ç”¨æˆ·å¤åˆ¶æˆåŠŸ
                self.status_label.text = "å¸®åŠ©æ–‡æ¡£å·²å¤åˆ¶åˆ°å‰ªè´´æ¿"
                self.result_text.value = "=== å¸®åŠ©æ–‡æ¡£è·å–æˆåŠŸ ===\n\nâœ… å¸®åŠ©æ–‡æ¡£å·²è‡ªåŠ¨å¤åˆ¶åˆ°å‰ªè´´æ¿\nğŸ“– æ‚¨å¯ä»¥ç›´æ¥ç²˜è´´åˆ°æ–‡æœ¬ç¼–è¾‘å™¨ä¸­æŸ¥çœ‹\n\nğŸŒ æ–‡æ¡£é“¾æ¥ï¼š\n" + help_url + "\n\nğŸ’¡ æç¤ºï¼š\nâ€¢ å¦‚æœå‰ªè´´æ¿å†…å®¹ä¸ºç©ºï¼Œè¯·æ‰‹åŠ¨è®¿é—®ä¸Šæ–¹é“¾æ¥\nâ€¢ æ–‡æ¡£åŒ…å«è¯¦ç»†çš„ä½¿ç”¨è¯´æ˜å’Œå¸¸è§é—®é¢˜è§£ç­”"
            
            except Exception as clipboard_error:  # å‰ªè´´æ¿æ“ä½œå¤±è´¥ï¼ˆå¦‚ç³»ç»Ÿæƒé™é™åˆ¶ï¼‰
                # æç¤ºç”¨æˆ·æ‰‹åŠ¨è®¿é—®é“¾æ¥ï¼Œæä¾›æ›¿ä»£æ–¹æ¡ˆ
                self.status_label.text = "å‰ªè´´æ¿æ“ä½œå¤±è´¥ï¼Œè¯·æ‰‹åŠ¨è®¿é—®"
                self.result_text.value = "=== å¸®åŠ©æ–‡æ¡£ ===\n\nâš ï¸ è‡ªåŠ¨å¤åˆ¶åˆ°å‰ªè´´æ¿å¤±è´¥\n\nğŸŒ è¯·æ‰‹åŠ¨è®¿é—®æ–‡æ¡£é“¾æ¥ï¼š\n" + help_url + "\n\nğŸ“‹ æ‚¨ä¹Ÿå¯ä»¥å¤åˆ¶ä¸‹é¢çš„é“¾æ¥ï¼š\n" + help_url + "\n\nğŸ’¡ å»ºè®®å°†æ–‡æ¡£é“¾æ¥ä¿å­˜åˆ°ä¹¦ç­¾ä»¥ä¾¿å¿«é€Ÿè®¿é—®"
        
        else:  # HTTPè¯·æ±‚å¤±è´¥ï¼ˆå¦‚æ–‡æ¡£é“¾æ¥å¤±æ•ˆï¼‰
            self.status_label.text = "æ— æ³•è®¿é—®å¸®åŠ©æ–‡æ¡£"
            self.result_text.value = f"=== è·å–å¸®åŠ©æ–‡æ¡£å¤±è´¥ ===\n\nâŒ HTTPé”™è¯¯: {response.status_code}\n\nğŸŒ è¯·æ‰‹åŠ¨è®¿é—®ï¼š\n" + help_url + "\n\nğŸ’¡ å¯èƒ½åŸå› ï¼š\nâ€¢ ç½‘ç»œè¿æ¥é—®é¢˜\nâ€¢ æœåŠ¡å™¨æš‚æ—¶ä¸å¯ç”¨\nâ€¢ æ–‡æ¡£é“¾æ¥å·²æ›´æ”¹"
    
    except Exception as e:  # æ•è·æ‰€æœ‰å¼‚å¸¸ï¼ˆå¦‚ç½‘ç»œè¿æ¥è¶…æ—¶ï¼‰
        self.status_label.text = "è·å–å¸®åŠ©å¤±è´¥"
        self.result_text.value = f"=== è·å–å¸®åŠ©æ–‡æ¡£æ—¶å‘ç”Ÿé”™è¯¯ ===\n\nğŸ”§ é”™è¯¯ä¿¡æ¯: {str(e)}\n\nğŸŒ è¯·æ‰‹åŠ¨è®¿é—®æ–‡æ¡£é“¾æ¥ï¼š\nhttps://docs.qq.com/document/DS2hWc29pSGVIa3dM\n\nğŸ’¡ å»ºè®®ï¼š\nâ€¢ æ£€æŸ¥ç½‘ç»œè¿æ¥\nâ€¢ ç¨åé‡è¯•\nâ€¢ æˆ–è€…æ‰‹åŠ¨è®¿é—®æ–‡æ¡£é“¾æ¥"
```
- **åŒæ¥æºä¿éšœ**ï¼šä¼˜å…ˆä»è…¾è®¯æ–‡æ¡£è·å–æœ€æ–°å¸®åŠ©å†…å®¹ï¼Œæå–å¤±è´¥æ—¶ä½¿ç”¨æœ¬åœ°é¢„è®¾å†…å®¹ï¼Œç¡®ä¿æ— ç½‘ç»œæˆ–é“¾æ¥å¤±æ•ˆæ—¶ä»èƒ½æä¾›åŸºç¡€æŒ‡å¼•ï¼›
- **å‰ªè´´æ¿ä¾¿æ·**ï¼šè‡ªåŠ¨å¤åˆ¶å¸®åŠ©å†…å®¹åˆ°å‰ªè´´æ¿ï¼Œç”¨æˆ·æ— éœ€æ‰‹åŠ¨é€‰ä¸­å¤åˆ¶ï¼Œæå‡æ“ä½œæ•ˆç‡ï¼›
- **å®¹é”™å®Œå–„**ï¼šè¦†ç›–â€œHTTPè¯·æ±‚å¤±è´¥ã€å‰ªè´´æ¿æ“ä½œå¤±è´¥ã€ç½‘ç»œå¼‚å¸¸â€ç­‰åœºæ™¯ï¼Œæä¾›æ‰‹åŠ¨è®¿é—®é“¾æ¥çš„æ›¿ä»£æ–¹æ¡ˆï¼Œé¿å…åŠŸèƒ½å®Œå…¨å¤±æ•ˆï¼›
- **å†…å®¹å®ç”¨**ï¼šå¸®åŠ©æ–‡æ¡£æ¶µç›–ä½¿ç”¨æµç¨‹ã€æŸ¥è¯¢ç±»å‹è¯¦è§£ã€å¸¸è§é—®é¢˜ï¼Œé’ˆå¯¹æ€§è§£ç­”ç”¨æˆ·é«˜é¢‘ç–‘é—®ï¼Œé™ä½ä½¿ç”¨é—¨æ§›ã€‚


## ä¹ã€ä»£ç å…¥å£ï¼ˆmainå‡½æ•°ï¼‰
ä»£ç é€šè¿‡`main`å‡½æ•°åˆå§‹åŒ–åº”ç”¨å¹¶å¯åŠ¨ä¸»å¾ªç¯ï¼Œæ˜¯åº”ç”¨çš„å…¥å£ç‚¹ï¼š
```python
def main():
    # åˆ›å»ºDFMQueryAppå®ä¾‹ï¼ŒæŒ‡å®šåº”ç”¨åç§°ä¸å”¯ä¸€æ ‡è¯†
    return DFMQueryApp("çƒ½ç«åœ°å¸¦æŸ¥è¯¢å·¥å…·", "com.dfm.query")

if __name__ == "__main__":
    # åˆå§‹åŒ–åº”ç”¨å¹¶å¯åŠ¨ä¸»å¾ªç¯ï¼ˆTogaæ¡†æ¶æ ¸å¿ƒï¼Œå¤„ç†UIäº‹ä»¶ä¸äº¤äº’ï¼‰
    app = main()
    app.main_loop()
```
- **åº”ç”¨æ ‡è¯†**ï¼š`com.dfm.query`ä¸ºåº”ç”¨å”¯ä¸€æ ‡è¯†ï¼Œç”¨äºTogaæ¡†æ¶åŒºåˆ†ä¸åŒåº”ç”¨ï¼›
- **ä¸»å¾ªç¯**ï¼š`app.main_loop()`å¯åŠ¨UIäº‹ä»¶å¾ªç¯ï¼Œå¤„ç†ç”¨æˆ·ç‚¹å‡»ã€è¾“å…¥ç­‰äº¤äº’ï¼Œç¡®ä¿åº”ç”¨æŒç»­è¿è¡Œã€‚


